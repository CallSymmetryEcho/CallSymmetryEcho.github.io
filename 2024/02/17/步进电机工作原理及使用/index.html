<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>步进电机工作原理及使用,自动泡片机制作 | Bin|Brain|Bin</title><meta name="keywords" content="robotic,ProjChatGPT,AI 辅助学习,Projects"><meta name="author" content="Bin Lian"><meta name="copyright" content="Bin Lian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="步进电机工作原理及使用,自动泡片机制作"><meta name="application-name" content="步进电机工作原理及使用,自动泡片机制作"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="步进电机工作原理及使用,自动泡片机制作"><meta property="og:url" content="http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/index.html"><meta property="og:site_name" content="Bin|Brain|Bin"><meta property="og:description" content="良好的学习资源：Stepper Motors and Arduino - The Ultimate Guide (howtomechatronics.com)How Stepper Motors Work认识步进驱动器 | 北岛夜话 (founderchip.com)步进电机基础知识：类型、用途和工"><meta property="og:locale" content="en"><meta property="og:image" content="https://lskypro.bin-lian.me/i/2025/01/01/6774a45202abc.png"><meta property="article:author" content="Bin Lian"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://lskypro.bin-lian.me/i/2025/01/01/6774a45202abc.png"><meta name="description" content="良好的学习资源：Stepper Motors and Arduino - The Ultimate Guide (howtomechatronics.com)How Stepper Motors Work认识步进驱动器 | 北岛夜话 (founderchip.com)步进电机基础知识：类型、用途和工"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//static.cloudflareinsights.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script defer="defer" data-pjax="data-pjax" src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon="{&quot;token&quot;: &quot;D3kKDJiPttJDVWdhPsNPds_8djzP7Q5CFlbyF_dA&quot;}"></script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w Come back soon - we miss you already!","backTitle":"♪(^∇^*)Welcome Back！"},
  LA51: {"enable":true,"ck":"3KngAPIX2BHSInNE","LingQueMonitorID":"3KngOdx82vNW79v3"},
  greetingBox: undefined,
  twikooEnvId: 'https://twikoo.bin-lian.me/',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":2},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: {"mode":"api","api":"https://img2color-go.vercel.app/api?img=","cover_change":true},
  authorStatus: {"skills":["🤖️ ROS, Chem Automation","🔍 ML&DL 4 Science","🏠 Nano Synthesis","🔨 DFT,MD,FDM Multiscale simulation","Solidworks, 3D modeling 🛠️","Down-to-earth action taker 🏃","Trying to use AI to make this world better🧱","Be Humble ☔️"]},
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"Author: Bin Lian","link":"Link: ","source":"Source: Bin|Brain|Bin","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: {"enable":true,"delay":100,"shiftDelay":200},
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Bin|Brain|Bin',
  title: '步进电机工作原理及使用,自动泡片机制作',
  postAI: '',
  pageFillDescription: '自己的代码和实现的项目, 步进电机的基本原理, 步进电机不同driver 的接线, Auto-immersion-lifter的实现, Aduino code, PCB板控制端给出串口由python接管调用功能, What is a Stepper Motor and How It Works?, How To Control NEMA17 Stepper Motor with Arduino and A4988 Stepper Driver, A4988 and Arduino Connection, A4988 Current Limiting, Stepper Motors and Arduino – Example Codes, Controlling Stepper Motors with Arduino and the AccelStepper Library – Examples, Example code – Stepper motor speed control using a potentiometer, Example code – Controlling two stepper motors with acceleration and deceleration, Example code – Controlling multiple stepper motors with AccelStepper library, CNC shield for controlling multiple stepper motors for any Arduino project, DRV8825 vs A4988, TMC2208 Stepper Driver, 2、步进驱动器的接线及设置, 2.4、步进电机的电流设置, 3、细分驱动设置, How the Stepper Motor work 步进电机工作原理, Working Principle, , Driving Modes, Stepper Motor Types by Construction, 步进电机基础知识, 步进电机工作原理, 步进电机的类型与构造, 转子, 定子, 步进电机的控制, 步进电机驱动器类型, 单极x2F双极电机, 步进电机驱动技术, 步进电机的优缺点, 优点：, 缺点：良好的学习资源认识步进驱动器北岛夜话步进电机基础知识类型用途和工作原理技术文章模拟工具推荐本博客创建为学习这个网站的笔记并且转载该博客内容自己的代码和实现的项目步进电机的基本原理参照博客收集与下文步进电机不同的接线的实现这里需要提及的是读取字符串的判断第一版写法可以成功读取但是无法满足判断条件怀疑是一起读取了于是使用检查并确认同时向学习数字的读取使用板控制端给出串口由接管调用功能定子转子步进驱动器的接线及设置目前市场上有很多步进驱动器各厂家的驱动器具有类似的接口都有信号电源电机等接线端子有输出电流及细分驱动设置的拨码开关本节以雷赛科技的步进驱动器为例介绍下步进驱动器的接线及设置是雷赛公司推出的两相步进电机驱动器采用脉冲方式进行控制支持档位电流及档位细分驱动输入电压范围输出峰值电流范围下面这张图是的外观图从图片中可以看出步进驱动器包括控制信号端子电源端子电机接线端子输出电流设置和细分驱动设置拨码开关等几部分组成控制信号端子控制信号端子与单片机或其它控制器相连接用来接收控制器发出的脉冲方向及使能控制信号脉冲信号脉冲信号有两个接线端子和连接脉冲信号正极连接脉冲信号负极脉冲信号以与的电压差来衡量拨码开关可设置脉冲的有效沿默认上升沿有效方向信号方向信号有两个接线端子和连接方向信号正极连接方向信号负极步进电机的初始运行方向与电机绕组的接线有关任何一组绕组互换比如和互换都能改变电机的初始运行方向电机在运行过程中的方向改变可以通过方向信号来控制为了保证步进电机可靠换向方向信号应早于脉冲信号至少建立使能信号使能信号用于使能或禁止驱动器输出有两个接线端子和连接使能信号正极连接使能信号负极当信号接通时驱动器将切断步进电机各相电源而使其处于自由状态该状态不响应脉冲信号注脉冲信号方向信号和使能信号输入电压值的大小可通过滑动开关来设置有和两种选择出厂默认报警信号驱动器故障信号输出用于连接到控制器的输入通道出厂默认正常情况下和是导通状态当驱动器报警时为截止状态可通过拨码开关设置抱闸信号步进电机的抱闸信号输入报警信号和抱闸信号的公共端电源接口电源接口包括个接线端子其中直流电源正极电压范围推荐直流电源负极电机接线端子电机接线端子包括其中和是步进电机的相绕组的两个接线柱和是步进电机的相绕组的两个接线柱下面这张图是步进电机驱动器的接线图步进电机的电流设置步进驱动器的中间有个拨码开关其中用来设置工作电流动态电流用来设置静止电流静态电流是细分设置将在第小节详细介绍工作电流设置通过设置步进驱动器的电流输出拨码开关可以改变驱动器的输出电流大小的拨码开关设置如下图所示当步进驱动器设置的输出电流越大时其连接的步进电机的输出力矩就越大但是电流过大会导致电机和驱动器发热严重时可能会损坏电机或驱动器因此在设置步进驱动器的电流时建议遵循如下原则四线电机设置输出电流等于或略小于电机的额定电流六线电机高力矩模式设置输出电流等于电机单极性接法额定电流的六线电机高速模式设置输出电流等于电机单极性接法额定电流的举个例子假设要用驱动雷赛步进电机该电机的额定电流为我们就采用输出均值电流的档位设置另外要注意步进电机的运动类型及停留时间的长短都会影响其发热量因此在实际使用中应视电机的发热情况适当调节输出电流的大小原则上如果电机运行分钟后如果表面温度低于度可适当增加电流设置值以增大输出扭矩但如果温升太高度则应降低电流的设置值静止电流设置拨码开关可用于设置步进电机在静止状态时驱动器的输出电流默认情况下它表示驱动器在没有接收到脉冲秒后将输出电流改变为峰值电流的这样可以降低驱动器和电机的发热如果将设置为则电机在静止状态下驱动器的输出电流为其峰值电流的细分驱动设置什么是细分驱动步进电机在出厂时都标注了固有步距角比如某电机的固有步距角为度度表示电机半步工作每次会转过度整步度在很多精密控制的场合固有步距角不能满足控制精度的要求人们希望能将一个固有步距角分很多步来走完这种将固有步距角再分成很多步的驱动方法称为细分驱动能实现细分驱动的驱动器称为细分驱动器细分驱动的优点细分驱动将固有步距角平均分成几份减少了每步的步距角的大小提高了步距均匀度提高了控制精度低频振荡是步进电机的固有特性细分驱动提高了电机的转动频率可以降低电机的振动细分驱动可以有效减少转矩波动提高输出转矩细分驱动的设置以为例该驱动器提供了四个拨码开关用来设置细分驱动如下图所示假设我们要把电机设置为步转即每转一圈需要个脉冲信号则拨码开关设置如下步进电机工作原理步进电机基础知识步进电机是一种通过步进即以固定的角度移动方式使轴旋转的电机其内部构造使它无需传感器通过简单的步数计算即可获知轴的确切角位置这种特性使它适用于多种应用转载步进电机基础知识类型用途和工作原理技术文章步进电机工作原理与所有电机一样步进电机也包括固定部分定子和活动部分转子定子上有缠绕了线圈的齿轮状突起而转子为永磁体或可变磁阻铁芯稍后我们将更深入地介绍不同的转子结构图显示的电机截面图其转子为可变磁阻铁芯图步进电机截面图步进电机的基本工作原理为给一个或多个定子相位通电线圈中通过的电流会产生磁场而转子会与该磁场对齐依次给不同的相位施加电压转子将旋转特定的角度并最终到达需要的位置图显示了其工作原理首先线圈通电并产生磁场转子与该磁场对齐线圈通电后转子顺时针旋转以与新的磁场对齐线圈通电后也会出现同样的情况下图中定子小齿的颜色指示出定子绕组产生的磁场方向图步进电机的步进步进电机的类型与构造步进电机的性能无论是分辨率步距速度还是扭矩都受构造细节的影响同时这些细节也可能会影响电机的控制方式实际上并非所有步进电机都具有相同的内部结构或构造因为不同电机的转子和定子配置都不同转子步进电机基本上有三种类型的转子永磁转子转子为永磁体与定子电路产生的磁场对齐这种转子可以保证良好的扭矩并具有制动扭矩这意味着无论线圈是否通电电机都能抵抗即使不是很强烈位置的变化但与其他转子类型相比其缺点是速度和分辨率都较低图显示了永磁步进电机的截面图图永磁步进电机可变磁阻转子转子由铁芯制成其形状特殊可以与磁场对齐请参见图和图这种转子更容易实现高速度和高分辨率但它产生的扭矩通常较低并且没有制动扭矩混合式转子这种转子具有特殊的结构它是永磁体和可变磁阻转子的混合体其转子上有两个轴向磁化的磁帽并且磁帽上有交替的小齿这种配置使电机同时具有永磁体和可变磁阻转子的优势尤其是具有高分辨率高速度和大扭矩当然更高的性能要求意味着更复杂的结构和更高的成本图显示了这种电机结构的简化示意图线圈通电后转子磁帽的一个小齿与磁化为的定子齿对齐与此同时由于转子的结构转子磁帽与磁化为的定子齿对齐尽管步进电机的工作原理是相同的但实际电机的结构更复杂齿数要比图中所示的更多大量的齿数可以使电机获得极小的步进角度小至图混合式步进电机定子定子是电机的一部分负责产生转子与之对齐的磁场定子电路的主要特性与其相数极对数以及导线配置相关相数是独立线圈的数量极对数则表示每相占用的主要齿对两相步进电机最常用三相和五相电机则较少使用请参见图和图图两相定子绕组左和三相定子绕组右图两相单极定子左和两相双极定子右在和之间施加正电压时产生的磁场用字母和表示步进电机的控制从上文我们知道电机线圈需要按特定的顺序通电以产生转子将与之对齐的磁场可以向线圈提供必要的电压以使电机正常运行的设备有以下几种从距离电机更近的设备开始晶体管桥从物理上控制电机线圈电气连接的设备晶体管可以看作是电控断路器它闭合时线圈连接到电源线圈中才有电流通过每个电机相位都需要一个晶体管电桥预驱动器控制晶体管激活的设备它由控制以提供所需的电压和电流通常由电机用户编程控制的微控制器单元它为预驱动器生成特定信号以获得所需的电机行为图为步进电机控制方案的简单示意图预驱动器和晶体管电桥可以包含在单个设备中即驱动器图电机控制基本方案步进电机驱动器类型市面上有各种不同的步进电机驱动器它们针对特定应用具有不同的功能但其最重要的特性之一与输入接口有关最常见的几种输入接口包括步进方向在引脚上发送一个脉冲驱动器即改变其输出使电机执行一次步进转动方向则由引脚上的电平来决定相位使能对每相的定子绕组来说决定该相是否通电决定该相电流方向直接控制上下管的栅极信号步进电机驱动器的另一个重要特性是除了控制绕组两端的电压它是否还可以控制流过绕组的电流拥有电压控制功能驱动器可以调节绕组上的电压产生的扭矩和步进速度仅取决于电机和负载特性电流控制驱动器更加先进因为它们可以调节流经有源线圈的电流更好地控制产生的扭矩从而更好地控制整个系统的动态行为单极双极电机另一个可能对电机控制产生影响的特性是其定子线圈的布置它决定了电流方向的变化方式为了实现转子的运动不仅要给线圈通电还要控制电流的方向而电流方向决定了线圈本身产生的磁场方向见图步进电机可以通过两种不同的方法来控制电流的方向图根据线圈电流方向控制磁场方向在单极步进电机中线圈的中心点连有一根引线请参见图这样可以通过相对简单的电路和组件来控制电流方向该中央引线连接输入电压见图如果导通则电流从流向如果导通则电流从流向在相反方向上产生磁场如上所述这种方法可以简化驱动电路仅需要两个半导体但缺点是一次仅使用了电机中铜导体的一半这意味着如果线圈中流过相同的电流则磁场强度仅为使用全部铜导体时的一半另外由于电机输入引线更多这类电机较难构造图单极步进电机驱动电路在双极步进电机中每个线圈只有两条引线而且为了控制方向必须使用桥请参见图如图所示如果和导通则电流从流向如果和导通则电流从流向产生相反方向的磁场这种方案需要更复杂的驱动电路但可以最大限度利用电机铜量而实现最大扭矩图双极步进电机驱动电路随着技术的不断进步单极电机的优势逐步弱化双极步进电机成为目前最流行的电机类型步进电机驱动技术步进电机主要有四种不同的驱动技术波动模式一次仅一个相位通电见图为简单起见如果电流从某相的正引线流向负引线例如从到则我们称为正向流动否则称为负向流动从下图左侧开始电流仅在相中正向流动而用磁体代表的转子与其所产生的磁场对齐接着电流仅在相中正向流动转子顺时针旋转以与相产生的磁场对齐随后相再次通电但电流负向流动转子再次旋转最后电流在相中负向流动而转子再次旋转图波动模式步进全步模式两相始终同时通电图显示了该驱动模式的步进步骤其步骤与波动模式类似最大的区别在于全步模式下由于电机中流动的电流更多产生的磁场也更强因此扭矩也更大图全步模式步进半步模式是波动模式和全步模式的组合请参见图这种模式可以将步距减小一倍旋转而不是其唯一的缺点是电机产生的扭矩不是恒定的当两相都通电时扭矩较高只有一相通电时扭矩较小图半步模式步进微步模式可以看作是半步模式的增强版因为它可以进一步减小步距并且具有恒定的扭矩输出这是通过控制每相流过的电流强度来实现的与其他方案相比微步模式需要更复杂的电机驱动器图显示了微步模式的工作原理假设是一个相位中可以通过的最大电流则从图中左侧开始在第一个图中下一步控制电流以达到它产生的磁场与前一个磁场相比顺时针旋转了控制电流达到不同的电流值并重复此步骤将磁场旋转和与半步模式相比它将步距减少了一半但还可以减少更多使用微步模式可以达到非常高的位置分辨率但其代价是需要更复杂的设备来控制电机并且每次步进产生的扭矩也更小扭矩与定子磁场和转子磁场之间的夹角正弦成正比因此当步距较小时扭矩也较小这有可能会导致丢步也就是说即使定子绕组中的电流发生了变化转子的位置也可能不改变图微步模式步进步进电机的优缺点现在我们已了解了步进电机的工作原理再总结一下各类电机的优缺点将非常有帮助优点得益于其内部结构步进电机不需要传感器来检测电机位置步进电机是通过执行步进来运动的因此只需简单地计算步数就可以获得给定时间的电机位置此外步进电机的控制非常简单它也需要驱动器但不需要复杂的计算或调整即可正常工作与其他电机相比其控制工作量通常很小而且如果采用微步模式还可以实现高达的位置精度步进电机在低速时可提供良好的扭矩也可以很好的保持位置而且使用寿命长缺点当负载扭矩过高时可能会失步由于无法获知电机的实际位置因此会对控制产生负面影响采用微步模式时更易产生此问题步进电机即使在静止时也总是消耗最大电流因此会降低效率并可能导致过热步进电机扭矩小在高速下会产生很大的噪音步进电机具有低功率密度和低扭矩惯性比总而言之当您需要成本低廉易于控制的解决方案且对高速时的效率和扭矩要求不高时步进电机是最好的选择要了解如何为您的项目选择正确的电机类型并进一步了解步进电机有刷电机和无刷电机之间的区别请单击此处',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-31 20:14:19',
  postMainColor: '',
  language: {
    default: '简体中文',
    available: ["简体中文","繁体中文","English"]
    },
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Website</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.bin-lian.me" title="My homepage"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738e9e3e093.png" alt="My homepage"/><span class="back-menu-item-text">My homepage</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">My services</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://lskypro.bin-lian.me/" title="Image Bed for Bin"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/677393fd15929.png" alt="Image Bed for Bin"/><span class="back-menu-item-text">Image Bed for Bin</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://myteslamate.bin-lian.me/" title="Teslamate"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67adaeace24f7.png" alt="Teslamate"/><span class="back-menu-item-text">Teslamate</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Local LLM &amp; knowledge database</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://myragflow.bin-lian.me/" title="RAGflow"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67adae37f12cd.png" alt="RAGflow"/><span class="back-menu-item-text">RAGflow</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">Bin|Brain|Bin</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> Posts</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> About Me</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> About Me</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> Life News</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> Random Post</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> Personal</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> Music</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> Album</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/67738f609ac4d.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://lskypro.bin-lian.me/i/2024/12/31/67738f609ac4d.jpg"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/67738f5e864b9.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://lskypro.bin-lian.me/i/2024/12/31/67738f5e864b9.jpg"/></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="https://buymeacoffee.com/bin_lian" target="_blank"><img class="post-qr-code-img" alt="Buy me A coffee" src="https://lskypro.bin-lian.me/i/2024/12/31/677391ee18dba.png"/></a><div class="post-qr-code-desc">Buy me A coffee</div></li><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/6773928a646a1.jpg" target="_blank"><img class="post-qr-code-img" alt="Paypal" src="https://lskypro.bin-lian.me/i/2024/12/31/6773928a646a1.jpg"/></a><div class="post-qr-code-desc">Paypal</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E8%AE%BA%E8%AF%AD/" style="font-size: 1.05rem;">#论语<sup>1</sup></a><a href="/tags/AI-%E8%BE%85%E5%8A%A9%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">AI 辅助学习<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 1.05rem;">LLM<sup>3</sup></a><a href="/tags/Mytesla/" style="font-size: 1.05rem;">Mytesla<sup>1</sup></a><a href="/tags/ProjChatGPT/" style="font-size: 1.05rem;">ProjChatGPT<sup>1</sup></a><a href="/tags/Projects/" style="font-size: 1.05rem;">Projects<sup>1</sup></a><a href="/tags/QuickNote/" style="font-size: 1.05rem;">QuickNote<sup>1</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>7</sup></a><a href="/tags/hexo/" style="font-size: 1.05rem;">hexo<sup>4</sup></a><a href="/tags/linux/" style="font-size: 1.05rem;">linux<sup>1</sup></a><a href="/tags/obsidian/" style="font-size: 1.05rem;">obsidian<sup>1</sup></a><a href="/tags/robotic/" style="font-size: 1.05rem;">robotic<sup>1</sup></a><a href="/tags/semiconductor/" style="font-size: 1.05rem;">semiconductor<sup>1</sup></a><a href="/tags/%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%80%E5%A7%8B/" style="font-size: 1.05rem;">为什么开始<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" style="font-size: 1.05rem;">内网穿透<sup>1</sup></a><a href="/tags/%E5%9B%BE%E5%BA%8A/" style="font-size: 1.05rem;">图床<sup>1</sup></a><a href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/" style="font-size: 1.05rem;">小技巧<sup>1</sup></a><a href="/tags/%E6%8C%87%E5%BC%B9%E7%BB%83%E4%B9%A0/" style="font-size: 1.05rem;">指弹练习<sup>1</sup></a><a href="/tags/%E8%A7%85%E9%A3%9F%E8%AE%B0/" style="font-size: 1.05rem;">觅食记<sup>1</sup></a><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">读书笔记<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">February 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">January 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">December 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">February 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创|Original creation</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/" itemprop="url">转载</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/Projects/" itemprop="url">Projects</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/Projects/PCB/" itemprop="url">PCB</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/robotic/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>robotic</span></a><a class="article-meta__tags" href="/tags/ProjChatGPT/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>ProjChatGPT</span></a><a class="article-meta__tags" href="/tags/AI-%E8%BE%85%E5%8A%A9%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>AI 辅助学习</span></a><a class="article-meta__tags" href="/tags/Projects/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Projects</span></a></span></div></div><h1 class="post-title" itemprop="name headline">步进电机工作原理及使用,自动泡片机制作</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-02-17T22:49:30.000Z" title="Created 2024-02-17 16:49:30">2024-02-17</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-01-01T02:14:19.708Z" title="Updated 2024-12-31 20:14:19">2024-12-31</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span id="" data-flag-title="步进电机工作原理及使用,自动泡片机制作"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">Post View:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为Austin,Texas"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>Austin,Texas</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://lskypro.bin-lian.me/i/2025/01/01/6774a45202abc.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/"><header><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/" itemprop="url">转载</a><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/Projects/" itemprop="url">Projects</a><a class="post-meta-categories" href="/categories/%E8%BD%AC%E8%BD%BD/Projects/PCB/" itemprop="url">PCB</a><a href="/tags/robotic/" tabindex="-1" itemprop="url">robotic</a><a href="/tags/ProjChatGPT/" tabindex="-1" itemprop="url">ProjChatGPT</a><a href="/tags/AI-%E8%BE%85%E5%8A%A9%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url">AI 辅助学习</a><a href="/tags/Projects/" tabindex="-1" itemprop="url">Projects</a><h1 id="CrawlerTitle" itemprop="name headline">步进电机工作原理及使用,自动泡片机制作</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Bin Lian</span><time itemprop="dateCreated datePublished" datetime="2024-02-17T22:49:30.000Z" title="Created 2024-02-17 16:49:30">2024-02-17</time><time itemprop="dateCreated datePublished" datetime="2025-01-01T02:14:19.708Z" title="Updated 2024-12-31 20:14:19">2024-12-31</time></header><p>良好的学习资源：<br><a target="_blank" rel="noopener" href="https://howtomechatronics.com/tutorials/arduino/stepper-motors-and-arduino-the-ultimate-guide/">Stepper Motors and Arduino - The Ultimate Guide (howtomechatronics.com)</a><br><a target="_blank" rel="noopener" href="https://howtomechatronics.com/how-it-works/electrical-engineering/stepper-motor/">How Stepper Motors Work</a><br><a target="_blank" rel="noopener" href="https://www.founderchip.com/?id=264">认识步进驱动器 | 北岛夜话 (founderchip.com)</a><br><a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/stepper-motors-basics-types-uses">步进电机基础知识：类型、用途和工作原理|技术文章|MPS (monolithicpower.cn)</a><br>模拟工具推荐：<br><a target="_blank" rel="noopener" href="https://www.tinkercad.com/">https://www.tinkercad.com/</a><br>本博客创建为学习这个网站的笔记，并且转载该博客内容</p>
<h2 id="自己的代码和实现的项目"><a href="#自己的代码和实现的项目" class="headerlink" title="自己的代码和实现的项目"></a>自己的代码和实现的项目</h2><h3 id="步进电机的基本原理"><a href="#步进电机的基本原理" class="headerlink" title="步进电机的基本原理"></a>步进电机的基本原理</h3><p>(参照 Dejan博客，收集与下文)</p>
<h3 id="步进电机不同driver-的接线"><a href="#步进电机不同driver-的接线" class="headerlink" title="步进电机不同driver 的接线"></a>步进电机不同driver 的接线</h3><p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/A4988-and-Arduino-Connection-Wiring-Diagram.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/a/8/b/a8b9af75b656c511818589df51bd7aad1739ac58190b1e46576ad40fac897b20.webp" alt="A4988 and Arduino Connection - Wiring Diagram"></a><br>A4988driver</p>
<p>![[markdown note&#x2F;Pasted image 20230217014307.png]]<br>TB6600</p>
<h3 id="Auto-immersion-lifter的实现"><a href="#Auto-immersion-lifter的实现" class="headerlink" title="Auto-immersion-lifter的实现"></a>Auto-immersion-lifter的实现</h3><h5 id="Aduino-code"><a href="#Aduino-code" class="headerlink" title="Aduino code:"></a>Aduino code:</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;AccelStepper.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the stepper motor and the pins that is connected to</span></span><br><span class="line"></span><br><span class="line">AccelStepper <span class="title function_">stepper1</span><span class="params">(<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>)</span>; <span class="comment">// (Typeof driver: with 2 pins, STEP, DIR)</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">Serial.begin(<span class="number">9600</span>);</span><br><span class="line"></span><br><span class="line">stepper1.setMaxSpeed(<span class="number">1000</span>); <span class="comment">// Set maximum speed value for the stepper</span></span><br><span class="line"></span><br><span class="line">stepper1.setAcceleration(<span class="number">500</span>); <span class="comment">// Set acceleration value for the stepper</span></span><br><span class="line"></span><br><span class="line">stepper1.setCurrentPosition(<span class="number">0</span>); <span class="comment">// Set the current position to 0 steps</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line"></span><br><span class="line">String incomingString = Serial.readStringUntil(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// Read until the &quot;Enter&quot; button is pressed</span></span><br><span class="line"></span><br><span class="line">incomingString.trim(); <span class="comment">// Remove leading/trailing whitespaces</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (incomingString == <span class="string">&quot;lift&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">Serial.println(<span class="string">&quot;Enter number of steps to move:&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (!Serial.available()); <span class="comment">// Wait until a character is received</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> stepsToMove = Serial.parseInt(); <span class="comment">// Read an integer from the serial buffer</span></span><br><span class="line"></span><br><span class="line">Serial.print(<span class="string">&quot;Moving UP by &quot;</span>);</span><br><span class="line"></span><br><span class="line">Serial.print(stepsToMove);</span><br><span class="line"></span><br><span class="line">Serial.println(<span class="string">&quot; steps&quot;</span>);</span><br><span class="line"></span><br><span class="line">stepper1.moveTo(stepsToMove); <span class="comment">// Set desired move: stepsToMove steps</span></span><br><span class="line"></span><br><span class="line">stepper1.runToPosition(); <span class="comment">// Moves the motor to target position</span></span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (incomingString == <span class="string">&quot;back&quot;</span>) &#123;</span><br><span class="line"></span><br><span class="line">Serial.println(<span class="string">&quot;Moving back to original position&quot;</span>);</span><br><span class="line"></span><br><span class="line">stepper1.moveTo(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">stepper1.runToPosition();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (incomingString == <span class="string">&quot;set0&quot;</span>)&#123;</span><br><span class="line"></span><br><span class="line">stepper1.setCurrentPosition(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要提及的是：读取字符串的判断,第一版写法：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">   String incomingString = Serial.readString();</span><br><span class="line">   <span class="keyword">if</span> (incomingString == <span class="string">&quot;lift&quot;</span>) &#123;</span><br><span class="line">     Serial.println(<span class="string">&quot;Moving down 15000 steps&quot;</span>);</span><br><span class="line">     stepper1.moveTo(<span class="number">15000</span>); <span class="comment">// Set desired move: 15000 steps</span></span><br><span class="line">     stepper1.runToPosition(); <span class="comment">// Moves the motor to target position with acceleration/deceleration and blocks until it is in position</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>可以成功读取，但是无法满足判断条件，怀疑是一起读取了’enter’ ‘\n’于是使用chatgpt 检查并确认,同时向Chatgpt 学习数字的读取使用Serial.parseInt()</p>
<p>Q:Could it be also because I type the “enter” botton and it be count as part of the string?</p>
<blockquote>
<p>A :Yes, that could be the problem. When you type a string followed by the “Enter” button, the “Enter” button is also sent as a character to the serial buffer, which is then read by the <code>Serial.readString()</code> function as part of the string.</p>
</blockquote>
<p>To solve this problem, you can use the <code>Serial.readStringUntil()</code> function instead of <code>Serial.readString()</code>. The <code>Serial.readStringUntil()</code> function reads the serial buffer until a specific character is encountered and then returns the received string.</p>
<p>Here’s the modified code that uses <code>Serial.readStringUntil()</code> to read the input string until the “Enter” button is pressed:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;AccelStepper.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the stepper motor and the pins that is connected to</span></span><br><span class="line">AccelStepper <span class="title function_">stepper1</span><span class="params">(<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>)</span>; <span class="comment">// (Typeof driver: with 2 pins, STEP, DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">  Serial.begin(<span class="number">9600</span>);</span><br><span class="line">  stepper1.setMaxSpeed(<span class="number">1000</span>); <span class="comment">// Set maximum speed value for the stepper</span></span><br><span class="line">  stepper1.setAcceleration(<span class="number">500</span>); <span class="comment">// Set acceleration value for the stepper</span></span><br><span class="line">  stepper1.setCurrentPosition(<span class="number">0</span>); <span class="comment">// Set the current position to 0 steps</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    String incomingString = Serial.readStringUntil(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// Read until the &quot;Enter&quot; button is pressed</span></span><br><span class="line">    incomingString.trim(); <span class="comment">// Remove leading/trailing whitespaces</span></span><br><span class="line">    <span class="keyword">if</span> (incomingString == <span class="string">&quot;lift&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Moving down&quot;</span>);</span><br><span class="line">      stepper1.moveTo(<span class="number">15000</span>); <span class="comment">// Set desired move: 15000 steps</span></span><br><span class="line">      stepper1.runToPosition(); <span class="comment">// Moves the motor to target position</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (incomingString == <span class="string">&quot;back&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Moving back to original position&quot;</span>);</span><br><span class="line">      stepper1.moveTo(<span class="number">0</span>);</span><br><span class="line">      stepper1.runToPosition();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The modified code reads the input string until the “Enter” button (<code>\n</code> character) is pressed and then removes the leading&#x2F;trailing whitespaces using the <code>String.trim()</code> function.</p>
<blockquote>
<p>Sure! To add a function that allows you to enter the moving steps from Python, you can use the <code>Seri al.parseInt()</code> function to read an integer value from the serial buffer.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">scss<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;AccelStepper.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the stepper motor and the pins that is connected to</span></span><br><span class="line">AccelStepper <span class="title function_">stepper1</span><span class="params">(<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>)</span>; <span class="comment">// (Typeof driver: with 2 pins, STEP, DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">  Serial.begin(<span class="number">9600</span>);</span><br><span class="line">  stepper1.setMaxSpeed(<span class="number">1000</span>); <span class="comment">// Set maximum speed value for the stepper</span></span><br><span class="line">  stepper1.setAcceleration(<span class="number">500</span>); <span class="comment">// Set acceleration value for the stepper</span></span><br><span class="line">  stepper1.setCurrentPosition(<span class="number">0</span>); <span class="comment">// Set the current position to 0 steps</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    String incomingString = Serial.readStringUntil(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// Read until the &quot;Enter&quot; button is pressed</span></span><br><span class="line">    incomingString.trim(); <span class="comment">// Remove leading/trailing whitespaces</span></span><br><span class="line">    <span class="keyword">if</span> (incomingString == <span class="string">&quot;lift&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Enter number of steps to move:&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span> (!Serial.available()); <span class="comment">// Wait until a character is received</span></span><br><span class="line">      <span class="type">int</span> stepsToMove = Serial.parseInt(); <span class="comment">// Read an integer from the serial buffer</span></span><br><span class="line">      Serial.print(<span class="string">&quot;Moving down by &quot;</span>);</span><br><span class="line">      Serial.print(stepsToMove);</span><br><span class="line">      Serial.println(<span class="string">&quot; steps&quot;</span>);<span class="comment">///same as.print</span></span><br><span class="line">      stepper1.moveTo(stepsToMove); <span class="comment">// Set desired move: stepsToMove steps</span></span><br><span class="line">      stepper1.runToPosition(); <span class="comment">// Moves the motor to target position</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (incomingString == <span class="string">&quot;back&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Moving back to original position&quot;</span>);</span><br><span class="line">      stepper1.moveTo(<span class="number">0</span>);</span><br><span class="line">      stepper1.runToPosition();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The modified code first waits for the “lift” command to be received, and then sends a prompt to enter the number of steps to move. It then waits for an integer value to be received from the serial buffer using the <code>Serial.parseInt()</code> function.</p>
<p>Once the number of steps is received, the motor is moved by the specified number of steps, and the action is confirmed with a message sent back to Python through the serial port.</p>
<h5 id="PCB板控制端，给出串口，由python接管调用功能"><a href="#PCB板控制端，给出串口，由python接管调用功能" class="headerlink" title="PCB板控制端，给出串口，由python接管调用功能"></a>PCB板控制端，给出串口，由python接管调用功能</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ser = serial.Serial(<span class="string">&#x27;/dev/cu.usbserial-14210&#x27;</span>, <span class="number">9600</span>)  </span><br><span class="line"><span class="comment"># wait for the Arduino to reset  </span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">True</span>):  </span><br><span class="line">        inp = <span class="built_in">input</span>(<span class="string">&#x27;Choose the mode: &#x27;</span>)  </span><br><span class="line">        <span class="keyword">if</span> inp == <span class="string">&#x27;q&#x27;</span>:  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">        <span class="keyword">elif</span> inp == <span class="string">&#x27;SI_tunning&#x27;</span>:  </span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">                command = <span class="built_in">input</span>(<span class="string">&#x27;Input command: &#x27;</span>)  </span><br><span class="line">                <span class="keyword">if</span> command ==<span class="string">&#x27;quit&#x27;</span>:  </span><br><span class="line">                    <span class="keyword">break</span> <span class="comment"># exit the SI mode loop and go back to the top-level loop  </span></span><br><span class="line">                ser.write(<span class="built_in">str</span>.encode(command))  </span><br><span class="line">                line = ser.readline().decode().rstrip()  </span><br><span class="line">                <span class="built_in">print</span>(line)  </span><br><span class="line">  </span><br><span class="line">        <span class="keyword">elif</span> inp ==<span class="string">&#x27;Si_etching&#x27;</span>:  </span><br><span class="line">            si_length = <span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&#x27;Si_length unit (um) &#x27;</span>))  </span><br><span class="line">            etching_speed =<span class="built_in">float</span>(<span class="built_in">input</span>(<span class="string">&#x27;etching speed(um/min) &#x27;</span>))  </span><br><span class="line">            si_etching_control(si_length,etching_speed,<span class="number">12000</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># close the serial connection  </span></span><br><span class="line">ser.close()</span><br></pre></td></tr></table></figure>
<h2 id="What-is-a-Stepper-Motor-and-How-It-Works"><a href="#What-is-a-Stepper-Motor-and-How-It-Works" class="headerlink" title="What is a Stepper Motor and How It Works?"></a>What is a Stepper Motor and How It Works?</h2><p>I will start with briefly explaining what is stepper motor and how it works, as it will help us better understand everything else in this tutorial. </p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Inside-of-NEMA-17-Stepper-motor-How-It-Works.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/a/c/0acb62bcb3d7ab5ee6d3a363ba0a9750be5d3ad625d26cf9ef357972213ac968.webp" alt="Inside of NEMA 17 Stepper motor - How It Works"></a></p>
<p>A stepper motor is a unique type of brushless DC motor which position can be precisely controlled even without any feedback.</p>
<p>The working principle of a stepper motor is based on magnetic fields. It has two main components, a stator(定子) and a rotor（转子）. The rotor is usually a permanent magnet and it’s surrounded by some coils on the stator.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Stepper-Motor-main-components-stator-and-a-rotor.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/b/d/2/bd2bb823bd18d25e746caa481f2d42b57bb6ba5d845be8024019064a22e47674.webp" alt="Stepper Motor main components - stator and a rotor"></a></p>
<p>When we energize or let current flow through the coils, particular magnetic fields are generated in the stator that either attract or repel the rotor. By activating the coils, step by step, one after another in a particular order, we can achieve continues motion of rotor, but also, we can make it stop at any position.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Stepper-Motor-Working-Principle.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/d/9/3/d93ec925c16dc1e78d5ae6b65de71bdc2b6c495e750148c81d77a53bed58e568.webp" alt="Stepper-Motor-Working-Principle"></a></p>
<p>So, that’s why these motors are called stepper motors, they move in discrete steps. </p>
<p>By increasing the number of magnetic poles on the rotor, we can increase the number of possible stopping positions, thus increase the resolution or the precision of the motor. Please note that this is just a basic explanation and you can find more details in my <a target="_blank" rel="noopener" href="https://howtomechatronics.com/how-it-works/electrical-engineering/stepper-motor/">How Stepper Motors Work</a> tutorial. </p>
<p>A typical stepper motor, a NEMA17 for example, has 50 stopping points or steps on the rotor. On the other hand, the stator can have several coils organized in two phases which provide four different magnetic field orientations or positions.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Stepper-motor-50-Steps-2-phases-and-4-different-magnetic-field-orientations-.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/5/c/e/5ced8b0a2dc533910da024db5d68d88f636641e4338d13cfbefe0d960b28b7f8.webp" alt="Stepper motor - 50 Steps, 2 phases and 4 different magnetic field orientations "></a></p>
<p>So, the 50 steps of the rotor multiplied by the 4 different magnetic field orientations, make total of 200 steps for completing a full rotation. Or if we divide 360 degrees by 200 steps, that’s a resolution of 1.8 degrees per step.</p>
<p>I mentioned that the stator coils are organized in two phases, and we can also notice that if we take a look at number of wires of a stepper motor. It has 4 four wires, two for each phase. The four different magnetic field orientations are possible as we can let current flow through the phases in both directions.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Current-flow-through-the-phases-stepper-motor-working-principle.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/9/a/09a39a9c62e5fecd59e42b9eb484dcdbea3f2cc775b67b8267cbbed5bcf88c03.webp" alt="Current flow through the phases - stepper motor working principle"></a></p>
<p>There also stepper motors with 5, 6 or even 8 wires, but they still work on two phases or we control them with just four terminals.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/6-wire-and-8-wire-stepper-motor-connection-in-bi-polar-configuration.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/5/7/8570c292188725ff738674152f9dc368992813b326647e949f7b8d44df8f5c98.webp" alt="6-wire and 8-wire stepper motor connection in bi-polar configuration"></a></p>
<p>The thing with them is that they can provide different performance characteristics, like more torque or more speed, depending on how we connect these wires on the four control terminals.</p>
<p>Nevertheless, with this brief explanation, now we understand that for driving a stepper motor, we cannot just connect power to it as nothing will happen. Instead, we have to energize the two motor phases in both directions, and activate or send pulses to them in particular order, in a timely sequence. So, that’s why we need drivers for controlling stepper motors. </p>
<p>There are many types and sizes of drivers, corresponding to the many types and sizes of stepper motors. However, the basic working principle of all of them is that they have two H-Bridges that allow energizing the motor phases in both directions.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/H-bridge-inside-a-stepper-motor-driver-how-it-works.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/d/3/7/d3783d35322b0665a7167189dd2508167591c19d9ea09eeff7e44244c6d5c82c.webp" alt="H-bridge inside a stepper motor driver - how it works"></a></p>
<p>Of course, they have many other functions like micro stepping, current limiting, and so on that enable us to easily control the stepper motors, which is the whole purpose of them.</p>
<h2 id="How-To-Control-NEMA17-Stepper-Motor-with-Arduino-and-A4988-Stepper-Driver"><a href="#How-To-Control-NEMA17-Stepper-Motor-with-Arduino-and-A4988-Stepper-Driver" class="headerlink" title="How To Control NEMA17 Stepper Motor with Arduino and A4988 Stepper Driver"></a>How To Control NEMA17 Stepper Motor with Arduino and A4988 Stepper Driver</h2><p>All right, now we can take a look at the first example for this tutorial, how to control a NEMA 17 stepper motor with an A4988 stepper driver. </p>
<p>All right, now we can take a look at the first example for this tutorial, how to control a NEMA 17 stepper motor with an A4988 stepper drive.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/4/a/7/4a7a3c8a5dfee3b288cc57c05d80cdfb344448e091f2336a81236c9426cac0ff.webp" alt="Stepper motor control with Arduino and A4988 stepper driver - example"></p>
<p>The NEMA17 is the most popular stepper motor among makers, as it offers great performances and it’s affordable at the same time. It can be also found in almost any desktop 3D printer and laser engraver. </p>
<p>Generally, the NEMA17 stepper motor has 200 steps, or 1.8 degrees per step resolution, but there are also models with 400 steps and 0.9 degrees per step resolution. We should note here that the designation NEMA17 actually describes just the size of the motor in terms of the front faceplate size.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/3/3/8333d100ccf79d6aa5fca83ac7195c4529f5bff7e1b220b737cc931a450b4470.webp" alt="NEMA designation meaning for stepper motors - NEMA17"></p>
<p>The number stands for the size of faceplate in inches when divided by 10, or in this case that would be 17 divided by 10 equals 1.7 inches faceplate, or 2.3 inches faceplate in case of NEMA23.</p>
<p>So, the faceplate size is fixed, but the length of the NEMA17 steppers can vary from 20mm to 60mm, and with that the power requirement of the motor also varies. The power requirement is usually defined by how much current the motor is allowed to draw, and the range for these NEMA17 steppers motors is from 0.3A up to 2.5A.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/4/3/1/431af86ce9a7292da217adb73f6ea291b6788579277b5dbda829b0e9f790a858.webp" alt="NEMA17 stepper motor length range from 20mm to 60mm"></p>
<p>Now, according to the current rating of the stepper motor, we need to choose a suitable driver which can handle that amount of current. The most popular driver controlling for NEMA17 stepper motors is the A4988 stepper motor driver.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/1/a/31a4d51c19629937e61ad6495c45b9d8e812758ff217e39d0a1165ec57909708.webp" alt="A4988 Stepper Driver"></p>
<p>The A4988 has a maximum current rating of 2A per coil, but that’s actually a peak rating. It is recommended to keep the current to around 1A, but of course, it is also possible to go up to 2A of good cooling is provided to the IC. </p>
<p>A great feature the A4988 stepper driver has, actually all other drives have, is the current limiting. With this we can easily set how much current the motor will draw no matter the motor rating. For example, we can connect even a 2.5A rated stepper motor, but we will limit the current of the driver to 1.5A. So, although the motor won’t work at its maximum capacity, we would still be able to use it.</p>
<p>On the other hand, if the motor is rated lower than the set current limit on the driver, the motor would overheat. Of course, it’s always recommended to try to match the current rating of the motor with the current rating of the driver.</p>
<h3 id="A4988-and-Arduino-Connection"><a href="#A4988-and-Arduino-Connection" class="headerlink" title="A4988 and Arduino Connection"></a>A4988 and Arduino Connection</h3><p>All right, so now let’s see how to connect the A4988 driver with the stepper motor and the Arduino controller.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/A4988-and-Arduino-Connection-Wiring-Diagram.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/a/8/b/a8b9af75b656c511818589df51bd7aad1739ac58190b1e46576ad40fac897b20.webp" alt="A4988 and Arduino Connection - Wiring Diagram"></a></p>
<p>At top right corner of the driver we have the VMOT and GND pins and here we connect the power supply for the motor which can range 8 to 36V. Here it is also recommended to use a decoupling capacitor across these two pins in order to protect the board from voltage spikes. We should use large electrolytic capacitor with at least 47uF capacity. </p>
<p>Next, are the four pins where we connect the stepper motor. One phase of the motor goes on 1A and 1B pins, and the other phase on 2A and 2B pins. </p>
<p>Sometimes, it can be a bit difficult to recognize which two wires of the motor make a phase, but are several ways to identify them. The simplest way is to rotate the shaft of the stepper motor by hand, and then connect two wires to each other. If you connect two wires that make a phase, the rotation of the shaft would be a bit more difficult.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/c/a/a/caa848bbf67be9ff08b10c9ca7ad5ef82b8c05d2997ab608107231b242ecf2aa.webp" alt="How to find a phase in a stepper motor - Easy method"></p>
<p>Another way is to use a multimeter and check for continuity between the two wires. If you connect two wires that make a phase, you will have a short circuit and the multimeter will start beeping.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/How-to-find-the-phase-of-a-stepper-motor-which-wires-make-a-phase.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/6/4/9/649d4d4db65cb6cce3e24ae53ae597d8d2004568ad52df346ac458cb5288294b.webp"></a></p>
<p>Once we find a phase, we can connect it to any position of the two positions on the driver, the order doesn’t matter. </p>
<p>Next, we have the IC or the logic power supply pins, VDD and GND, which can be from 3V to 5V. On the other side we have the Step and the Direction pins, which can be connected to any pin of the Arduino board. With the Direction pin we select the rotation direction of the motor, and with the Step pin we control to steps of the motor. With each pulse we send to the Step pin, the motor will advance one step in the selected direction. </p>
<p>Right above these pins, we have the Sleep and the Reset pins which are used for, as their names suggest, putting the driver to sleep mode or resetting it. We should note that both of these pins are active low. The Sleep pin by default is HIGH state, but the RST pin is floating. That means in order to have the driver enabled, the easiest way is to just connect these two pins to each other, assuming we won’t use these pins functions. </p>
<p>The Enable pin is also active low, so unless we pull it HIGH, the driver will be enabled. </p>
<p>The next three pins, MS1, MS2 and MS3, are for selecting the step resolution of the motor. We already said that the step resolution depends on the construction of the motor which is usually 200 steps per revolution for a NEMA 17 stepper motor. However, all stepper drivers have this feature called microstepping which allows driving the motor at higher resolutions. This is achieved by energizing the coils at an intermediate current level, which produce intermediate step locations.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Steppers-control-with-Microstepping-intermediate-current-levels-on-the-motors-coils.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/5/6/0/560a19b475a999ff9cef51b3538b7dce9787fd88d223312a2a8a7da3f4eadb48.webp"></a></p>
<p>For example, if we select quarter-step resolution, the 200 steps of the motor will become, 200 multiplied by 4 equals 800 microsteps per revolution. The driver will use four different current levels on the coils to achieve this. </p>
<p>The A4988 driver has a maximum resolution of 16 microsteps, which would make a 200 steps NEMA17 motor has 3200 steps per revolution, or that’s 0.1125 degrees per step. That’s really impressive precision and that’s why these types of stepper motors and drivers are used in so many applications. Actually, there are stepper drivers that have up 256 microsteps, or that’s a whopping 51200 steps per revolution, or 0.007 degrees per step.</p>
<p>Nevertheless, these three pins have pull-down resistors, so if we leave them disconnected, the driver will work in full-step mode. For selecting a different mircrostepping resolution we need to connect 5V to the appropriate pins according to this table. </p>
<h3 id="A4988-Current-Limiting"><a href="#A4988-Current-Limiting" class="headerlink" title="A4988 Current Limiting"></a>A4988 Current Limiting</h3><p>All right, so now that we know how to connect the stepper motor and the driver to the Arduino board, we can move on with explaining how to program or code the Arduino for controlling the stepper. However, before we do that, or before we power the motor, there is one more very important thing that we need to do, and that’s to adjust the current limit of the driver.</p>
<p>As we already explained, we need to adjust the current limit of the driver to be lower than the current rating of the motor, or otherwise the motor would overheat.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Setting-the-A4988-current-limit-by-measuring-the-reference-voltage.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/6/7/8/67827386ae9536df9e16b5bdbccb2a6cd47b0e2b60d9d0d6ce18dc93e7442292.webp"></a></p>
<p>There’s a small trimmer potentiometer on the A4988 driver though which we can adjust the current limit. By rotating the potentiometer clockwise, the current limit raises, and vice versa. There are two methods which can be used for determining the actual value of the current limit. </p>
<p>The first method involves measuring the reference voltage across the potentiometer itself and GND. We can measure the reference voltage using a multimeter, and use that value in the following formula to calculate the current limit of the driver:</p>
<p><strong><em>Current Limit &#x3D; Vref &#x2F; (8 x Rcs)</em></strong></p>
<p>The Rcs is the current sense resistance or the values of the current sensing resistors located right next to the chip. Depending on the manufacturer, these values are usually 0.05, 0.1 or 0.2 ohms. So, we need to take a closer look at the value of these resistors in order to accurately calculate the current limit with this method. In my case, these resistors were labeled R100, which meant 0.1ohms.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/A4988-stepper-driver-current-sensing-resistors-for-calculating-the-current-limit-using-the-voltage-reference.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/4/5/6/456dfd9c2170b319fde863a3bf6220fde03558aeed9fbe26d90be92345c255cb.webp"></a></p>
<p>As an example, if we measure a reference voltage of 0.7V, and we have 0.1 ohms resistors, the current limit would be a 0.875A. Or if we want to limit the current to, let’s say 1A, we should adjust the reference voltage to 0.8V. </p>
<p>The second method for setting the current limit is by directly measure the current through the coils. For that purpose, we need to connect the stepper motor and the driver as explained previously. We can skip the controller connection, but instead connect 5V to the Direction and the Step pins so that the motor stays active and holds one position. The MS pins should be left disconnected so the driver would work in full-step mode. Then we can disconnect one line or coil from the motor, and connect it in series with an ammeter. In this way, once we power the driver with both the logic voltage, the 5V, and the power for the motor 12V in my case, we can read how much current is running through the coil.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/9/c/6/9c67b09577dd6bbf67fd1150e4370b3c9aadda04c74b6a6095051fe970e9cb27.webp"></p>
<p>Though, we should note here that when the driver works in full-step mode, the current in the coils can reach only 70% of the actually current limit. So, when using the driver in the other microstepping modes, the reading from the ammeter should be multiplied by 1.3 in order to get the actual value of the current limit of the driver. </p>
<p>I tried both methods for setting up the current limit of the driver and they gave me approximately the same results.</p>
<h2 id="Stepper-Motors-and-Arduino-–-Example-Codes"><a href="#Stepper-Motors-and-Arduino-–-Example-Codes" class="headerlink" title="Stepper Motors and Arduino – Example Codes"></a>Stepper Motors and Arduino – Example Codes</h2><p>Nevertheless, now we can move on with programming the Arduino, or take a look at several example codes for controlling a stepper motor with an Arduino board.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/d/c/9/dc9b8b3fe5e6546286c8d3571261d25033f1355c0f384e267d0a984599cf09b6.webp"></p>
<p>Let’s start with a very basic example code of how to control a stepper motor without using a library.</p>
<p><strong>Example code 1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">/*   </span><br><span class="line"> *   Basic example code for controlling a stepper without library</span><br><span class="line"> *      </span><br><span class="line"> *   by Dejan, https://howtomechatronics.com</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">// defines pins</span><br><span class="line">#define stepPin 2</span><br><span class="line">#define dirPin 5 </span><br><span class="line"> </span><br><span class="line">void setup() &#123;</span><br><span class="line">  // Sets the two pins as Outputs</span><br><span class="line">  pinMode(stepPin,OUTPUT); </span><br><span class="line">  pinMode(dirPin,OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line">void loop() &#123;</span><br><span class="line">  digitalWrite(dirPin,HIGH); // Enables the motor to move in a particular direction</span><br><span class="line">  // Makes 200 pulses for making one full cycle rotation</span><br><span class="line">  for(int x = 0; x &lt; 800; x++) &#123;</span><br><span class="line">    digitalWrite(stepPin,HIGH); </span><br><span class="line">    delayMicroseconds(700);    // by changing this time delay between the steps we can change the rotation speed</span><br><span class="line">    digitalWrite(stepPin,LOW); </span><br><span class="line">    delayMicroseconds(700); </span><br><span class="line">  &#125;</span><br><span class="line">  delay(1000); // One second delay</span><br><span class="line">  </span><br><span class="line">  digitalWrite(dirPin,LOW); //Changes the rotations direction</span><br><span class="line">  // Makes 400 pulses for making two full cycle rotation</span><br><span class="line">  for(int x = 0; x &lt; 1600; x++) &#123;</span><br><span class="line">    digitalWrite(stepPin,HIGH);</span><br><span class="line">    delayMicroseconds(500);</span><br><span class="line">    digitalWrite(stepPin,LOW);</span><br><span class="line">    delayMicroseconds(500);</span><br><span class="line">  &#125;</span><br><span class="line">  delay(1000);</span><br><span class="line">&#125;Code language: Arduino (arduino)</span><br></pre></td></tr></table></figure>

<p><strong>Code description:</strong></p>
<p>Here all we have to do is define to which pin number the STEP and DIR pins are connected and define them as outputs. In the loop, first we set the rotation direction of the motor by making the Direction pin status HIGH. Then using a “for” loop we send 200 pulses to the STEP pin which will make the motor rotate a full cycle, considering that it works in full-step mode. The pulses are generated simply by toggling the state of the STEP pin HIGH to LOW with some time delay between them. This time delay actually defines the speed of rotation. If we lower it, the speed of rotation will increase as the steps will occur faster, and vice versa. </p>
<p>Then we change the rotation direction, and using another “for” loop we send 400 pulses which would make to motor rotate two full cycles. However, if we change the microstepping mode of the driver, let’s say so a quarter-step, which would make the motor have 800 steps now, the first loop will make the motor rotate only 90 degrees, and the second loop only half rotation.</p>
<p><strong>Example code 2</strong></p>
<p>Here’s another simple example, controlling the stepper motor speed using a potentiometer.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Controlling-stepper-motor-speed-with-potentiometer-Wiring-diagram.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/e/1/9/e19ee224862fb7c9507ae7840390878913c4c5579e8fcd6e5d416768df0e5e32.webp"></a></p>
<p>For that purpose, just have to connect the potentiometer to the Arduino and read its value using the analogRead() function.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">     Basic example code for controlling a stepper without library</span><br><span class="line"></span><br><span class="line">     by Dejan, https://howtomechatronics.com</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">// defines pins</span><br><span class="line">#define stepPin 2</span><br><span class="line">#define dirPin 5</span><br><span class="line"></span><br><span class="line">int customDelay, customDelayMapped;</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  // Sets the two pins as Outputs</span><br><span class="line">  pinMode(stepPin, OUTPUT);</span><br><span class="line">  pinMode(dirPin, OUTPUT);</span><br><span class="line">&#125;</span><br><span class="line">void loop() &#123;</span><br><span class="line">  speedControl();</span><br><span class="line">  // Makes pules with custom delay, depending on the Potentiometer, from which the speed of the motor depends</span><br><span class="line">  digitalWrite(stepPin, HIGH);</span><br><span class="line">  delayMicroseconds(customDelayMapped);</span><br><span class="line">  digitalWrite(stepPin, LOW);</span><br><span class="line">  delayMicroseconds(customDelayMapped);</span><br><span class="line">&#125;</span><br><span class="line">// Custom function for reading the potentiometer and mapping its value from 300 to 3000, suitable for the custom delay value in microseconds</span><br><span class="line">void speedControl() &#123;</span><br><span class="line">  customDelay = analogRead(A0); // Read the potentiometer value</span><br><span class="line">  customDelayMapped = map(customDelay, 0, 1023, 300, 3000); // Convert the analog input from 0 to 1024, to 300 to 3000</span><br><span class="line">&#125;Code language: Arduino (arduino)</span><br></pre></td></tr></table></figure>

<p><strong>Code description:</strong></p>
<p>We can then map or convert the potentiometer values which are from 0 to 1023, to values suitable for being a delay time in microseconds for the Step pulses. I found the minimum value for the delay between steps to be around 300 microseconds. By going lower that that the stepper motor started skipping steps. </p>
<p>Overall, controlling stepper motors with this method is easy and it works, but only if the required control is simple as shown in the examples. In case we need more complex control, the best way is to use an Arduino library.</p>
<h2 id="Controlling-Stepper-Motors-with-Arduino-and-the-AccelStepper-Library-–-Examples"><a href="#Controlling-Stepper-Motors-with-Arduino-and-the-AccelStepper-Library-–-Examples" class="headerlink" title="Controlling Stepper Motors with Arduino and the AccelStepper Library – Examples"></a>Controlling Stepper Motors with Arduino and the AccelStepper Library – Examples</h2><p>The most popular library for controlling stepper motors with Arduino is the <a target="_blank" rel="noopener" href="https://www.airspayce.com/mikem/arduino/AccelStepper/">AccelStepper library by Mike McCauley</a>. It’s an extremely versatile library featuring speed, acceleration and deceleration control, setting target positions, controlling multiple stepper motors simultaneously and so on.</p>
<p>The library has a great documentation explaining how each function work. I have already used this library for several of my Arduino projects, for controlling the motion of my <a target="_blank" rel="noopener" href="https://howtomechatronics.com/tutorials/arduino/diy-motorized-camera-slider-pan-tilt-head-project/">DIY Camera Slider</a>, the <a target="_blank" rel="noopener" href="https://howtomechatronics.com/projects/arduino-3d-wire-bending-machine/">3D wire bending machine</a>, the <a target="_blank" rel="noopener" href="https://howtomechatronics.com/projects/scara-robot-how-to-build-your-own-arduino-based-robot/">SCARA robot arm</a> and few others. In case you are interested, there are details and code explanations for each project on the website. </p>
<p>Now let’s take a look at few examples code using this library.</p>
<h3 id="Example-code-–-Stepper-motor-speed-control-using-a-potentiometer"><a href="#Example-code-–-Stepper-motor-speed-control-using-a-potentiometer" class="headerlink" title="Example code – Stepper motor speed control using a potentiometer"></a>Example code – Stepper motor speed control using a potentiometer</h3><p>The first example will be controlling the speed of the motor using the potentiometer.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/*   </span><br><span class="line"> *   Basic example code for controlling a stepper with the AccelStepper library</span><br><span class="line"> *      </span><br><span class="line"> *   by Dejan, https://howtomechatronics.com</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">#include &lt;AccelStepper.h&gt;</span><br><span class="line"></span><br><span class="line">// Define the stepper motor and the pins that is connected to</span><br><span class="line">AccelStepper stepper1(1, 2, 5); // (Type of driver: with 2 pins, STEP, DIR)</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  // Set maximum speed value for the stepper</span><br><span class="line">  stepper1.setMaxSpeed(1000);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  stepper1.setSpeed((analogRead(A0));</span><br><span class="line">  // Step the motor with a constant speed previously set by setSpeed();</span><br><span class="line">  stepper1.runSpeed();</span><br><span class="line">&#125;Code language: Arduino (arduino)</span><br></pre></td></tr></table></figure>

<p><strong>Code description:</strong></p>
<p>So, here first we need to include the AccelStepper library. Of course, before we do that, we need to install the library and we can do that from the Arduino IDE library manager. We just have to search “AccelStepper” and the library will show up and we can install it. </p>
<p>Then, we need to create an instance of the AccelStepper class for our motor. The first parameter here is the type of driver, in this case for a driver with two control pins this value is 1, and the other two parameters are the pin numbers to which our driver is connect to the Arduino. If we have multiple stepper motors, we need to define each of them like this, and we can name them however we want, in this case I named my motor stepper1. </p>
<p>In the setup section we just have to set the maximum speed of the motor which is defined as steps per second. This value can go up to 4000, but in the documentation of the library it is stated that speed values of more than 1000 steps per seconds might be unreliable. </p>
<p>In the loop section, using the setSpeed() function we set the current speed of the motor, and in this case that’s the analog input from the potentiometer which is from 0 to 1023.</p>
<p>In order the motor to move and implement that constant speed, we need to call the runSpeed() function each interval. A negative value here, or simply including a minus sign before the value, would make the stepper motor rotate in the opposite direction.</p>
<h3 id="Example-code-–-Controlling-two-stepper-motors-with-acceleration-and-deceleration"><a href="#Example-code-–-Controlling-two-stepper-motors-with-acceleration-and-deceleration" class="headerlink" title="Example code – Controlling two stepper motors with acceleration and deceleration"></a>Example code – Controlling two stepper motors with acceleration and deceleration</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/9/0/e/90e95724437c85ca66f3c850586c75cefed18174b0210e02f45b11d4abb87f82.webp" alt="Controlling two stepper motors with acceleration and deceleration"></p>
<p>Here’s another example of controlling two stepper motors with implementing acceleration and deceleration using the AccelStepper library.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">    Controlling two stepper with the AccelStepper library</span><br><span class="line"></span><br><span class="line">     by Dejan, https://howtomechatronics.com</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#include &lt;AccelStepper.h&gt;</span><br><span class="line"></span><br><span class="line">// Define the stepper motor and the pins that is connected to</span><br><span class="line">AccelStepper stepper1(1, 2, 5); // (Typeof driver: with 2 pins, STEP, DIR)</span><br><span class="line">AccelStepper stepper2(1, 3, 6);</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line"></span><br><span class="line">  stepper1.setMaxSpeed(1000); // Set maximum speed value for the stepper</span><br><span class="line">  stepper1.setAcceleration(500); // Set acceleration value for the stepper</span><br><span class="line">  stepper1.setCurrentPosition(0); // Set the current position to 0 steps</span><br><span class="line"></span><br><span class="line">  stepper2.setMaxSpeed(1000);</span><br><span class="line">  stepper2.setAcceleration(500);</span><br><span class="line">  stepper2.setCurrentPosition(0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line"></span><br><span class="line">  stepper1.moveTo(800); // Set desired move: 800 steps (in quater-step resolution that&#x27;s one rotation)</span><br><span class="line">  stepper1.runToPosition(); // Moves the motor to target position w/ acceleration/ deceleration and it blocks until is in position</span><br><span class="line"></span><br><span class="line">  stepper2.moveTo(1600);</span><br><span class="line">  stepper2.runToPosition();</span><br><span class="line"></span><br><span class="line">  // Move back to position 0, using run() which is non-blocking - both motors will move at the same time</span><br><span class="line">  stepper1.moveTo(0);</span><br><span class="line">  stepper2.moveTo(0);</span><br><span class="line">  while (stepper1.currentPosition() != 0 || stepper2.currentPosition() != 0) &#123;</span><br><span class="line">    stepper1.run();  // Move or step the motor implementing accelerations and decelerations to achieve the target position. Non-blocking function</span><br><span class="line">    stepper2.run();</span><br><span class="line">    //</span><br><span class="line">    //</span><br><span class="line">  &#125;</span><br><span class="line">&#125;Code language: Arduino (arduino)</span><br></pre></td></tr></table></figure>

<p><strong>Code description:</strong></p>
<p>So, we need to define the two stepper motors, and in the setup, using the setAcceleration() function set the acceleration value for the motors. Using the setCurrentPosition() function we set the position of the motors to be at 0 steps. </p>
<p>In the loop section, we start with the moveTo() function through which we tell the motor to what position to go or how many steps it should move. In case of quarter-step resolution, 800 steps would mean one full rotation. Then, the runToPosition() function moves the motor to that position while implementing acceleration and deceleration. However, this is a blocking function, so the code execution will stay there until the stepper motor reaches that position. </p>
<p>With the same method we move the second motor 1600 steps or two full rotations with quarter-step resolution. </p>
<p>If we don’t want our code to be blocked until the motor reach the target position, instead of using the runToPosition() function, we should use the run() function. The run() also implements acceleration and deceleration to achieve the target position, but it just makes one step per call. Therefore, we need to call it as frequently as possible. For that reason, here we put the run() functions for both motors in this while loop, which is executed until both steppers reach position 0. We previously set the two motors to go to position 0 with the moveTo() functions. </p>
<p>We could also add more code in that “while” loop and do other stuff too along running the motor. Actually, there are many methods of running the motors and doing other stuff too. I recommend going through the nicely described documentation of the library so you can understand how each function works and implement them according to your needs.</p>
<h3 id="Example-code-–-Controlling-multiple-stepper-motors-with-AccelStepper-library"><a href="#Example-code-–-Controlling-multiple-stepper-motors-with-AccelStepper-library" class="headerlink" title="Example code – Controlling multiple stepper motors with AccelStepper library"></a>Example code – Controlling multiple stepper motors with AccelStepper library</h3><p>I would like to show you one more example using the AccelStepper library and that’s controlling multiple stepper motors in a coordinated fashion. This means, we can set target positions for each stepper and they can reach their positions all at the same time, no matter the different distance they need to travel.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Controlling-multiple-stepper-motors-with-AccelStepper-library.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/f/5/0f5d444973e1f201c7934a37f0435094f5b582961bd4520c31a4a2a0dd7aafd5.webp"></a></p>
<p>This can be easily done using the MultiStepper class that comes with the AccelStepper library.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">    Controlling multiple steppers with the AccelStepper and MultiStepper library</span><br><span class="line"></span><br><span class="line">     by Dejan, https://howtomechatronics.com</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">#include &lt;AccelStepper.h&gt;</span><br><span class="line">#include &lt;MultiStepper.h&gt;</span><br><span class="line"></span><br><span class="line">// Define the stepper motor and the pins that is connected to</span><br><span class="line">AccelStepper stepper1(1, 2, 5); // (Typeof driver: with 2 pins, STEP, DIR)</span><br><span class="line">AccelStepper stepper2(1, 3, 6);</span><br><span class="line">AccelStepper stepper3(1, 4, 7);</span><br><span class="line"></span><br><span class="line">MultiStepper steppersControl;  // Create instance of MultiStepper</span><br><span class="line"></span><br><span class="line">long gotoposition[3]; // An array to store the target positions for each stepper motor</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line"></span><br><span class="line">  stepper1.setMaxSpeed(1000); // Set maximum speed value for the stepper</span><br><span class="line">  stepper2.setMaxSpeed(1000);</span><br><span class="line">  stepper3.setMaxSpeed(1000);</span><br><span class="line"></span><br><span class="line">  // Adding the 3 steppers to the steppersControl instance for multi stepper control</span><br><span class="line">  steppersControl.addStepper(stepper1);</span><br><span class="line">  steppersControl.addStepper(stepper2);</span><br><span class="line">  steppersControl.addStepper(stepper3);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  // Store the target positions in the &quot;gotopostion&quot; array</span><br><span class="line">  gotoposition[0] = 800;  // 800 steps - full rotation with quater-step resolution</span><br><span class="line">  gotoposition[1] = 1600;</span><br><span class="line">  gotoposition[2] = 3200;</span><br><span class="line"></span><br><span class="line">  steppersControl.moveTo(gotoposition); // Calculates the required speed for all motors</span><br><span class="line">  steppersControl.runSpeedToPosition(); // Blocks until all steppers are in position</span><br><span class="line"></span><br><span class="line">  delay(1000);</span><br><span class="line"></span><br><span class="line">  gotoposition[0] = 0;</span><br><span class="line">  gotoposition[1] = 0;</span><br><span class="line">  gotoposition[2] = 0;</span><br><span class="line"></span><br><span class="line">  steppersControl.moveTo(gotoposition);</span><br><span class="line">  steppersControl.runSpeedToPosition();</span><br><span class="line"></span><br><span class="line">  delay(1000);</span><br><span class="line">&#125;Code language: Arduino (arduino)</span><br></pre></td></tr></table></figure>

<p><strong>Code description:</strong></p>
<p>Here we also need to include the MultiStepper class, and create an instance of it. Then we need to define an array, type “long”, which will be used for storing the target positions for our motors. In the setup section, we need to define the maximum speed values of the steppers and add the steppers to the previously created MultiStepper instance, which in my case I named it “steppersControl”. </p>
<p>In the loop section, we start by storing the target position values in the array that we previously created. I set the first stepper to move one rotation, the second, two rotations and the third one, three rotations. Then we can assign this array to the moveTo() function which will calculate the required speeds for all motors to arrive at those positions at the same time. Then we just have to call the runSpeedToPosition() function which will move the motors to their position. Though we should note that this function blocks the code until the steppers reach their target position. We could use the run() function instead, if we don’t want to block the code. We should also note that the MultiStepper class doesn’t support acceleration and deceleration. </p>
<p>Nevertheless, if you want to learn more, from more advanced examples, you can check my Arduino projects that I already mentioned, all the details and the codes for them are on the website.</p>
<h2 id="CNC-shield-for-controlling-multiple-stepper-motors-for-any-Arduino-project"><a href="#CNC-shield-for-controlling-multiple-stepper-motors-for-any-Arduino-project" class="headerlink" title="CNC shield for controlling multiple stepper motors for any Arduino project"></a>CNC shield for controlling multiple stepper motors for any Arduino project</h2><p>Still taking about controlling multiple stepper motors, it’s worth mentioning and taking a look at the Arduino CNC shield.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/CNC-Shield-for-controlling-multiple-stepper-motors-for-any-Arduino-project.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/f/f/0ff2089762c823551a1839195d6dca0f607b69d24d038a267289f9cd98e5ecac.webp"></a></p>
<p>The main purpose of the Arduino CNC shield is for controlling 2 or 3-axis CNC machines, but it is actually a great option for controlling any type of project where we need to control multiple stepper motors as it is compact and provides easy connections for the drivers and the motors. </p>
<p>This shield goes on top of an Arduino UNO board, and can control up to 4 individual stepper motors, and have all the remaining Arduino pins available for use. I used this combination of an Arduino UNO board and the CNC shield for controlling my <a target="_blank" rel="noopener" href="https://howtomechatronics.com/projects/scara-robot-how-to-build-your-own-arduino-based-robot/">4-axis SCARA robot arm</a>.</p>
<p>I will update this section of the article, how to use the CNC shield with Arduino with more details soon.</p>
<h2 id="DRV8825-vs-A4988"><a href="#DRV8825-vs-A4988" class="headerlink" title="DRV8825 vs A4988"></a>DRV8825 vs A4988</h2><p>All right, so now let’s move on and see how we can control stepper motors using the other driver that I mentioned at the beginning, the DRV8825.</p>
<p>Actually, everything we explained so far about controlling stepper motors with the A4988 stepper driver, applies for the DRV8825 as well. The working principle, the connections and the coding are almost the same for both of these drivers. The difference between them is in their technical characteristics and now we will take a look at them and compare them.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/DRV8825-vs-A4988-stepper-drivers.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/9/2/f/92fc6c9d12050c487acddec179bb798556831535af7befd96304cf395a305968.webp" alt="DRV8825 vs A4988"></a></p>
<p>The DRV8825 is a stepper driver by Texas Instruments which can be used as direct replacement for the Allegro A4988 driver as their connections are the same. The three key differences between them are that the DR8825 can deliver more current than the A4988 without additional cooling (1.5A vs 1A), it has higher maximum supply voltage (45V vs 35V), and it offers higher microstepping resolution (32 vs 16 microsteps). </p>
<p>Of course, they also have some other minor differences. For example, the current limit potentiometer has a different location and the relationship between the current limit setting and the reference pin voltage is different. The DRV8825 doesn’t need logic power supply, and the that pin location is used as FAULT output.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/DRV8825-vs-A4988-pinout.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/4/f/d/4fdb72689961006646fa3be3fbeaabd82b5bd7862bf9c0c2287947e8b801d521.webp"></a></p>
<p>However, it is safe to connect the FAULT pin directly to 5V, so the DRV8825 can be used as a direct replacement in systems designed for the A4988 driver. </p>
<p>It’s worth noting though, that when replacing an A4988 driver with an DRV8825 it is very important to make sure the orientation of the driver is correct. I already mentioned, their potentiometers are at different locations, on the A4988 it’s below the chip, and on the DRV8825 is above the chip, and that can sometimes cause confusion and the driver can be easily placed on the wrong side. </p>
<p>For setting the current limit, we can measure the reference voltage with one probe on GND and the other on the potentiometer itself.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/Adjusting-the-current-limit-of-the-DRV8825-stepper-driver.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/6/8/a/68a5c0abd32c183b93b3058734a9d94881eea3d6f8cd0e070fb2868eae666aba.webp" alt="Adjusting the current limit of the DRV8825 stepper driver"></a></p>
<p>The formula for calculating for the DRV8825 stepper drive is as follow:</p>
<p><strong><em>Current limit &#x3D; Vref x 2</em></strong></p>
<p>As for selecting the microstepping resolution, we can use the following table.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/2/9/9/299b7c288e3fae9be66eabb01c55fa14284ddd470a7686ff8216e19e00476ad6.webp"></p>
<p>Overall, the DRV8825 is a better stepper driver than the A4988, as it offers higher current and voltage ratings, and higher microstepping resolution which results in smoother and quieter operation of the stepper motor.</p>
<h2 id="TMC2208-Stepper-Driver"><a href="#TMC2208-Stepper-Driver" class="headerlink" title="TMC2208 Stepper Driver"></a>TMC2208 Stepper Driver</h2><p>Speaking of smoother and quieter operation, let’s take a look at the TMC2208 stepper driver. The TMC2208 chip is made by Trinamic, a Germany based company specialized in motion control electronics. The TMC2208 is a silent stepper motor driver which can be also used as a direct replacement in systems designed for the A4988 or the DRV8825 drivers. It is widely used in desktop 3D printers, laser engravers, scanners and so on.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/TMC2208-vs-A4988-vs-DRV8825-stepper-motor-drivers.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/5/6/85679ac9647f55dca7480cd5084ab3db263090417f7867ed0a766da5c7797332.webp" alt="TMC2208 vs A4988 vs DRV8825 stepper motor drivers"></a></p>
<p>What sets this driver apart from the two others is its integrated interpolation unit which provides 256 subdivisions or microsteps. This allows for perfect sinusoidal control which is generated internally within the chip. This means that the driver will output 256 microsteps to the stepper motor, no matter what microstep resolution we have selected through the two MS pins, 2, 4, 8 or 16 microsteps. This provides smoother operation and reduces the burden of the microcontroller significantly.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/TMC2208-256-subdivisions-or-microsteps-with-integrated-interpolation-from-2-4-8-or-16-microsteps.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/b/b/3bb6d25566b4600528ae19a4b87513db48b8d628e1e0bb065d4984b6dfc29ddb.webp"></a></p>
<p>This feature of the driver, in combination with the its noiseless current control StealthChop2 technology, provide that ultra-silent control of the stepper motors. Here’s a comparison of the noise levels between the three drivers.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/TMC2208-vs-A4988-vs-DRV8825-Noise-Levels-Comparison.jpg"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/f/5/0f55e4b9d55374ff4bbfffedd2b77afd908c68a2f7662d710d4bd3289288e32c.webp" alt="TMC2208 vs A4988 vs DRV8825 Noise Levels Comparison"></a></p>
<p><strong>Stepper driver noise levels:</strong> A4988 around 65dB, DRV8825 around 67dB and TMC2208 around 41dB.</p>
<p>The TMC2208 drives the stepper motors completely silently, which is really impressive.</p>
<p>The current rating of the TMC2208 is slightly higher than the A4988 driver, or it’s 1.2A with 2A peak current. For setting the current limit of the driver, again we can use the same method as explained for the other drivers. We need to measure the reference voltage with one probe on GND, and other on the whole right next to the Enable pin.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/TMC2208-current-limiting-by-measuring-the-reference-voltage.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/0/3/d/03d7179df6e1a891485f9f268e944007ea609104f8edd32c910add1ddbf2dd43.webp" alt="TMC2208 current limiting by measuring the reference voltage"></a></p>
<p>The formula for calculating the current limit is as follow:</p>
<p><strong><em>Current limit &#x3D; Vref x 0.71</em></strong></p>
<p>Although it can be used as direct replacement, the TMC2208 driver has a slightly different pinout compared to the A4988 driver. Here we only have two pins for selecting the microsteps resolution and for enabling the driver we need to connect the Enable pin to GND.</p>
<p><a target="_blank" rel="noopener" href="https://howtomechatronics.com/wp-content/uploads/2022/05/TMC2208-and-Arduino-Connection-Wiring-diagram-and-microstepping-table.png"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/f/6/e/f6e3e6e37943907d5c1537e3d9f39d2855042e28fc566663b4b8091e49ca1659.webp" alt="TMC2208 and Arduino Connection - Wiring diagram and microstepping table"></a></p>
<p>In terms of coding, it’s the same as the other two drivers. </p>
<p>The TMC2208 driver also have some other, more advanced features compared to the two other drivers, like for example, a simple-to-use UART interface which provides controlling the driver with just a single line, instead of the two Step and Dir pins. In addition to that I provides more tuning and control options. </p>
<p>Overall, the TMC2208 is a better driver that the A4988 and the DRV8825, but that’s normal as it comes with a higher price tag. Though, if you don’t need these extra features and the noise levels doesn’t concern you, are other two drivers are just great choice.</p>
<h3 id="2、步进驱动器的接线及设置"><a href="#2、步进驱动器的接线及设置" class="headerlink" title="2、步进驱动器的接线及设置"></a>2、步进驱动器的接线及设置</h3><p>目前市场上有很多步进驱动器，各厂家的驱动器具有类似的接口，都有信号、电源、电机等接线端子；有输出电流及细分驱动设置的拨码开关。本节以雷赛科技（LeadShine）的DM542步进驱动器为例，介绍下步进驱动器的接线及设置。</p>
<p>DM542是雷赛公司推出的两相步进电机驱动器，采用脉冲方式进行控制，支持8档位电流及16档位细分驱动；输入电压范围：DC 20V<del>50V，输出峰值电流范围：1.0</del>4.2A；下面这张图是DM542的外观图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.founderchip.com/zb_users/upload/2020/01/20200120165509_79003.png" alt="leisai_DM542.png" title="leisai_DM542.png"></p>
<p>从图片中可以看出，DM542步进驱动器包括控制信号端子、电源端子、电机接线端子、输出电流设置和细分驱动设置拨码开关等几部分组成。</p>
<p><strong>2.1、控制信号端子</strong></p>
<p>控制信号端子与PLC、单片机或其它控制器相连接，用来接收控制器发出的脉冲、方向及使能控制信号。</p>
<p>2.1.1、脉冲信号（Pulse）</p>
<p>脉冲信号有两个接线端子：PUL+和PUL-。”PUL+”连接脉冲信号正极，“PUL-”连接脉冲信号负极；脉冲信号以”PUL+”与”PUL-“的电压差来衡量；拨码开关SW13可设置脉冲的有效沿，默认（SW13&#x3D;OFF）上升沿有效；</p>
<p>2.1.2、方向信号（Direction）</p>
<p>方向信号有两个接线端子：DIR+和DIR-。”DIR+”连接方向信号正极，”DIR-“连接方向信号负极；步进电机的初始运行方向与电机绕组的接线有关，任何一组绕组互换（比如：A+和A-互换）都能改变电机的初始运行方向；电机在运行过程中的方向改变可以通过方向信号来控制，为了保证步进电机可靠换向，方向信号应早于脉冲信号至少5us建立；</p>
<p>2.1.3、使能信号（Enable）</p>
<p>使能信号用于使能或禁止驱动器输出，有两个接线端子：ENA+和ENA-。”ENA+”连接使能信号正极，”ENA-“连接使能信号负极；当”ENA+”信号接通时，驱动器将切断步进电机各相电源而使其处于自由状态，该状态不响应脉冲信号；</p>
<p>注：脉冲信号、方向信号和使能信号输入电压值的大小可通过滑动开关来设置，有DC 5V和DC 24V两种选择，出厂默认DC 24V；</p>
<p>2.1.4、报警信号（Alarm）</p>
<p>驱动器故障信号输出，用于连接到PLC&#x2F;控制器的输入通道。出厂默认正常情况下ALM和COM是导通状态，当驱动器报警时为截止状态；可通过拨码开关SW12设置；</p>
<p>2.1.4、抱闸信号（Brake）：步进电机的抱闸信号输入；</p>
<p>2.1.5、COM：报警信号和抱闸信号的公共端；</p>
<p><strong>2.2、电源接口</strong></p>
<p>电源接口包括2个接线端子：+Vdc、GND，其中：</p>
<p>+Vdc：直流电源正极，电压范围：+20V<del>+50V，推荐+24V</del>+48V；</p>
<p>GND：直流电源负极；</p>
<p><strong>2.3、电机接线端子</strong></p>
<p>电机接线端子包括：A+、A-、B+、B-，其中：</p>
<p>A+和A-是步进电机的A相绕组的两个接线柱；</p>
<p>B+和B-是步进电机的B相绕组的两个接线柱；</p>
<p>下面这张图是步进电机驱动器的接线图：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.founderchip.com/zb_users/upload/2020/01/20200120165509_64056.png" alt="步进驱动器接线图.png" title="步进驱动器接线图.png"></p>
<h3 id="2-4、步进电机的电流设置"><a href="#2-4、步进电机的电流设置" class="headerlink" title="2.4、步进电机的电流设置"></a><strong>2.4、步进电机的电流设置</strong></h3><p>DM542步进驱动器的中间有8个拨码开关（SW1<del>SW8），其中SW1</del>SW3用来设置工作电流（动态电流）；SW4用来设置静止电流（静态电流）；SW5~SW8是细分设置（将在第3小节详细介绍）；</p>
<p><strong>2.4.1、工作电流设置</strong></p>
<p>通过设置步进驱动器的电流输出拨码开关，可以改变驱动器的输出电流大小。DM542的SW1~SW3拨码开关设置如下图所示：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.founderchip.com/zb_users/upload/2020/01/20200120165509_42724.png" alt="sw1_sw3.png" title="sw1_sw3.png"></p>
<p>当步进驱动器设置的输出电流越大时，其连接的步进电机的输出力矩就越大。但是电流过大会导致电机和驱动器发热，严重时可能会损坏电机或驱动器。因此在设置步进驱动器的电流时建议遵循如下原则：</p>
<ul>
<li><p>四线电机：设置输出电流等于或略小于电机的额定电流；</p>
</li>
<li><p>六线电机高力矩模式：设置输出电流等于电机单极性接法额定电流的50%；</p>
</li>
<li><p>六线电机高速模式：设置输出电流等于电机单极性接法额定电流的100%；</p>
</li>
</ul>
<p>举个例子：假设要用DM542驱动雷赛42CM06步进电机，该电机的额定电流为2.5A，我们就采用输出均值电流2.36A的档位，设置SW1&#x3D;OFF，SW2&#x3D;ON，SW3&#x3D;OFF；</p>
<p>另外要注意：步进电机的运动类型及停留时间的长短，都会影响其发热量。因此在实际使用中应视电机的发热情况适当调节输出电流的大小。原则上如果电机运行15~30分钟后如果表面温度低于40度，可适当增加电流设置值以增大输出扭矩；但如果温升太高（&gt;70度），则应降低电流的设置值；</p>
<p><strong>2.4.2、静止电流设置</strong></p>
<p>拨码开关SW4可用于设置步进电机在静止状态时驱动器的输出电流。默认情况下SW4&#x3D;OFF，它表示驱动器在没有接收到脉冲0.4秒后，将输出电流改变为峰值电流的50%，这样可以降低驱动器和电机的发热；如果将SW4设置为ON，则电机在静止状态下，驱动器的输出电流为其峰值电流的90%；</p>
<h3 id="3、细分驱动设置"><a href="#3、细分驱动设置" class="headerlink" title="3、细分驱动设置"></a>3、细分驱动设置</h3><p><strong>3.1、什么是细分驱动？</strong></p>
<p>步进电机在出厂时都标注了“固有步距角”。比如某电机的固有步距角为0.9度&#x2F;1.8度，表示电机半步工作每次会转过0.9度，整步1.8度。在很多精密控制的场合，固有步距角不能满足控制精度的要求，人们希望能将一个固有步距角分很多步来走完。这种将固有步距角再分成很多步的驱动方法，称为”细分驱动”。能实现细分驱动的驱动器，称为”细分驱动器”。</p>
<p><strong>3.2、细分驱动的优点</strong></p>
<ul>
<li><p>细分驱动将固有步距角平均分成几份，减少了每步的步距角的大小，提高了步距均匀度，提高了控制精度；</p>
</li>
<li><p>低频振荡是步进电机的固有特性，细分驱动提高了电机的转动频率，可以降低电机的振动；</p>
</li>
<li><p>细分驱动可以有效减少转矩波动，提高输出转矩；</p>
</li>
</ul>
<p><strong>3.4、细分驱动的设置</strong></p>
<p>以DM542为例，该驱动器提供了四个拨码开关（SW5~SW8）用来设置细分驱动，如下图所示：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.founderchip.com/zb_users/upload/2020/01/20200120165509_65889.png" alt="sw5_sw8.png" title="sw5_sw8.png"></p>
<p>假设我们要把电机设置为3200步&#x2F;转（即每转一圈需要3200个脉冲信号），则拨码开关设置如下：SW5&#x3D;ON，SW6&#x3D;ON，SW7&#x3D;OFF，SW8&#x3D;ON  </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;AccelStepper.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Define the stepper motor and the pins that is connected to</span></span><br><span class="line">AccelStepper <span class="title function_">stepper1</span><span class="params">(<span class="number">1</span>, <span class="number">3</span>, <span class="number">7</span>)</span>; <span class="comment">// (Typeof driver: with 2 pins, STEP, DIR)</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">setup</span><span class="params">()</span> &#123;</span><br><span class="line">  Serial.begin(<span class="number">9600</span>);</span><br><span class="line">  stepper1.setMaxSpeed(<span class="number">1000</span>); <span class="comment">// Set maximum speed value for the stepper</span></span><br><span class="line">  stepper1.setAcceleration(<span class="number">500</span>); <span class="comment">// Set acceleration value for the stepper</span></span><br><span class="line">  stepper1.setCurrentPosition(<span class="number">0</span>); <span class="comment">// Set the current position to 0 steps</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">loop</span><span class="params">()</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (Serial.available() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    String incomingString = Serial.readStringUntil(<span class="string">&#x27;\n&#x27;</span>); <span class="comment">// Read until the &quot;Enter&quot; button is pressed</span></span><br><span class="line">    incomingString.trim(); <span class="comment">// Remove leading/trailing whitespaces</span></span><br><span class="line">    <span class="keyword">if</span> (incomingString == <span class="string">&quot;lift&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Moving down&quot;</span>);</span><br><span class="line">      stepper1.moveTo(<span class="number">15000</span>); <span class="comment">// Set desired move: 15000 steps</span></span><br><span class="line">      stepper1.runToPosition(); <span class="comment">// Moves the motor to target position</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (incomingString == <span class="string">&quot;back&quot;</span>) &#123;</span><br><span class="line">      Serial.println(<span class="string">&quot;Moving back to original position&quot;</span>);</span><br><span class="line">      stepper1.moveTo(<span class="number">0</span>);</span><br><span class="line">      stepper1.runToPosition();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<p>Sure, here’s an example Arduino sketch that reads a string from the serial port and prints it to the Serial Monitor:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">arduinovoid setup() &#123;</span><br><span class="line">  // initialize serial communication at 9600 baud rate</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  if (Serial.available() &gt; 0) &#123;</span><br><span class="line">    // read the incoming string and store it in a variable</span><br><span class="line">    String incomingString = Serial.readString();</span><br><span class="line">    </span><br><span class="line">    // print the incoming string to the Serial Monitor</span><br><span class="line">    Serial.println(incomingString);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This code listens for incoming data on the serial port, and when data is available, it reads the string and stores it in a variable. It then prints the incoming string to the Serial Monitor, allowing you to see the text data that is being sent from your Python program or other serial device. Note that <code>Serial.readString()</code> will read all the characters in the serial buffer until it reaches a newline character (<code>\n</code>) or the timeout period expires. So, make sure to send your string with a newline character at the end or adjust the timeout value, if necessary.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p>&#x2F;* Controlling two stepper with the AccelStepper library by Dejan, <a target="_blank" rel="noopener" href="https://howtomechatronics.com/">https://howtomechatronics.com</a> *&#x2F; #include &lt;AccelStepper.h&gt; &#x2F;&#x2F; Define the stepper motor and the pins that is connected to AccelStepper stepper1(1, 3, 7); &#x2F;&#x2F; (Typeof driver: with 2 pins, STEP, DIR) void setup() { Serial.begin(9600); stepper1.setMaxSpeed(1000); &#x2F;&#x2F; Set maximum speed value for the stepper stepper1.setAcceleration(500); &#x2F;&#x2F; Set acceleration value for the stepper stepper1.setCurrentPosition(0); &#x2F;&#x2F; Set the current position to 0 steps } void loop() { if (Serial.available()&gt;0){ String incomingString &#x3D; Serial.readString(); if (incomingString &#x3D;&#x3D; ‘drop’) { Serial.print(“success run into drop mode”); stepper1.moveTo(15000); &#x2F;&#x2F; Set desired move: 800 steps (in quater-step resolution that’s one rotation) stepper1.runToPosition(); &#x2F;&#x2F; Moves the motor to target position w&#x2F; acceleration&#x2F; deceleration and it blocks until is in position } &#x2F;&#x2F;print the incoming string to the Serial Monitor if (incomingString &#x3D;&#x3D; ‘back’) { Serial.print(“Backing into original position “); stepper1.moveTo(0); stepper1.runToPosition(); } } } check this code, I want to achieve the motor move down 15000 when I type in “lift” and back to the original position when I type”back”</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p>I want to achieve the motor move down 15000 when I type in “lift” and back to the original position when I type”back”</p>
<p>I’m sorry, I made a mistake in my previous response. Here’s the corrected code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">arduino#include &lt;AccelStepper.h&gt;</span><br><span class="line"></span><br><span class="line">// Define the stepper motor and the pins that it is connected to</span><br><span class="line">AccelStepper stepper1(1, 3, 7); // (Type of driver: with 2 pins, STEP, DIR)</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line">  stepper1.setMaxSpeed(1000); // Set maximum speed value for the stepper</span><br><span class="line">  stepper1.setAcceleration(500); // Set acceleration value for the stepper</span><br><span class="line">  stepper1.setCurrentPosition(0); // Set the current position to 0 steps</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  if (Serial.available() &gt; 0) &#123;</span><br><span class="line">    String incomingString = Serial.readString();</span><br><span class="line">    if (incomingString == &quot;lift&quot;) &#123;</span><br><span class="line">      Serial.println(&quot;Moving down 15000 steps&quot;);</span><br><span class="line">      stepper1.moveTo(15000); // Set desired move: 15000 steps</span><br><span class="line">      stepper1.runToPosition(); // Moves the motor to target position with acceleration/deceleration and blocks until it is in position</span><br><span class="line">    &#125;</span><br><span class="line">    else if (incomingString == &quot;back&quot;) &#123;</span><br><span class="line">      Serial.println(&quot;Moving back to original position&quot;);</span><br><span class="line">      stepper1.moveTo(0); // Set desired move: 0 steps (back to original position)</span><br><span class="line">      stepper1.runToPosition(); // Moves the motor to target position with acceleration/deceleration and blocks until it is in position</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This code listens for incoming data on the serial port, and when data is available, it reads the string and stores it in a variable. It then checks if the incoming string is equal to “lift” or “back”, and if it is, it sets the desired move for the stepper motor and calls <code>runToPosition()</code> to move the motor to the target position. Note that the <code>moveTo()</code> function sets the absolute position for the motor, so you don’t need to keep track of the current position manually. Also, make sure to enclose the string values in double quotes, not single quotes.</p>
<p>If none of these suggestions work, please provide more information about the issue you are facing, including any error messages or symptoms you are observing.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p>Hardware work properly but When I type”lift” the code failed to make a judge</p>
<p>It looks like there might be a problem with the <code>if</code> statements in your <code>loop()</code> function. The <code>if</code> statements are checking for a character instead of a string. Here’s the corrected code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">scss#include &lt;AccelStepper.h&gt;</span><br><span class="line"></span><br><span class="line">// Define the stepper motor and the pins that is connected to</span><br><span class="line">AccelStepper stepper1(1, 3, 7); // (Typeof driver: with 2 pins, STEP, DIR)</span><br><span class="line"></span><br><span class="line">void setup() &#123;</span><br><span class="line">  Serial.begin(9600);</span><br><span class="line">  stepper1.setMaxSpeed(1000); // Set maximum speed value for the stepper</span><br><span class="line">  stepper1.setAcceleration(500); // Set acceleration value for the stepper</span><br><span class="line">  stepper1.setCurrentPosition(0); // Set the current position to 0 steps</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void loop() &#123;</span><br><span class="line">  if (Serial.available() &gt; 0) &#123;</span><br><span class="line">    String incomingString = Serial.readString();</span><br><span class="line">    if (incomingString == &quot;lift&quot;) &#123;</span><br><span class="line">      Serial.println(&quot;Moving down&quot;);</span><br><span class="line">      stepper1.moveTo(15000); // Set desired move: 15000 steps</span><br><span class="line">      stepper1.runToPosition(); // Moves the motor to target position</span><br><span class="line">    &#125; else if (incomingString == &quot;back&quot;) &#123;</span><br><span class="line">      Serial.println(&quot;Moving back to original position&quot;);</span><br><span class="line">      stepper1.moveTo(0);</span><br><span class="line">      stepper1.runToPosition();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>The corrected code checks for a string input using double quotes (<code>&quot;</code>) instead of a character input using single quotes (<code>&#39;</code>). The <code>Serial.println()</code> function is also used instead of <code>Serial.print()</code> to add a line break after the text message.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p>ser.write(b’100\n’) what is b’s function</p>
<p>In Python, the <code>b</code> prefix before a string literal creates a bytes object rather than a regular string object. Bytes objects are similar to string objects, but they represent a sequence of bytes rather than a sequence of characters.</p>
<p>In the line <code>ser.write(b&#39;100\n&#39;)</code>, the <code>b</code> prefix is used to create a bytes object containing the string “100\n”. The <code>write()</code> method of a serial object expects a bytes object as input, so the <code>b</code> prefix is necessary to convert the string to bytes before it is sent over the serial port.</p>
<p>Without the <code>b</code> prefix, the <code>write()</code> method would expect a regular string object, and a <code>TypeError</code> would be raised when attempting to send the string over the serial port.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p><code>ser.read()</code> is a method in Python that reads a certain number of bytes from a serial port and returns them as a bytes object. It waits for incoming data to be available, then reads the specified number of bytes or until a timeout occurs.</p>
<p>If no argument is provided, <code>ser.read()</code> will read a single byte from the serial port. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pythonimport serial</span><br><span class="line"></span><br><span class="line">ser = serial.Serial(&#x27;/dev/ttyACM0&#x27;, 9600)</span><br><span class="line"></span><br><span class="line">data = ser.read() # Read a single byte from the serial port</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>If an argument <code>size</code> is provided, <code>ser.read(size)</code> will read and return <code>size</code> bytes from the serial port. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pythonimport serial</span><br><span class="line"></span><br><span class="line">ser = serial.Serial(&#x27;/dev/ttyACM0&#x27;, 9600)</span><br><span class="line"></span><br><span class="line">data = ser.read(10) # Read 10 bytes from the serial port</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://chat.openai.com/_next/image?url=https://lh3.googleusercontent.com/a/AEdFTp4JmUpX3g9eCc8g_mWlzi2zUqL2P0yb2DvzqoEBdQ=s96-c&w=64&q=75" alt="killer LB"></p>
<p>how to read serial message by line in python</p>
<p>To read serial messages by line in Python, you can use the <code>readline()</code> method of a serial object. This method reads from the serial port until it encounters a newline character (<code>\n</code>) or carriage return (<code>\r</code>) and returns all the characters it read up to that point.</p>
<p>Here’s an example code snippet that demonstrates how to use <code>readline()</code> to read serial messages by line:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pythonimport serial</span><br><span class="line"></span><br><span class="line">ser = serial.Serial(&#x27;/dev/ttyACM0&#x27;, 9600)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    line = ser.readline()</span><br><span class="line">    print(line)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>In this example, the code creates a serial object for the port <code>/dev/ttyACM0</code> with a baud rate of 9600. It then enters an infinite loop and calls <code>readline()</code> on the serial object to read one line of text from the serial port. The code then prints the line to the console. The loop continues indefinitely, reading and printing lines from the serial port as they are received.</p>
<p>Note that <code>readline()</code> will block until it receives a full line of text, so the loop will pause until a full line is received. If the sender is not sending complete lines of text, you may need to modify the code to handle partial lines or use a different approach for reading from the serial port.</p>
<h1 id="How-the-Stepper-Motor-work-步进电机工作原理"><a href="#How-the-Stepper-Motor-work-步进电机工作原理" class="headerlink" title="How the Stepper Motor work 步进电机工作原理"></a>How the Stepper Motor work 步进电机工作原理</h1><p>In this tutorial article you will learn how a stepper motor works. We will cover the basic working principles of stepper motors, their driving modes and the steppers types by construction. You can watch the following video or read the written article.</p>
<p>  <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/e/d/9/ed9f5a8665d48d971a2975263acc7af050d667d9657978d59fd10a7adecf543c.jpg"></p>
<h2 id="Working-Principle"><a href="#Working-Principle" class="headerlink" title="Working Principle"></a>Working Principle</h2><p>Stepper motor is a brushless DC motor that rotates in steps. This is very useful because it can be precisely positioned without any feedback sensor, which represents an open-loop controller. The stepper motor consists of a rotor that is generally a permanent magnet and it is surrounded by the windings of the stator. As we activate the windings step by step in a particular order and let a current flow through them they will magnetize the stator and make electromagnetic poles respectively that will cause propulsion to the motor. So that’ the basic working principle of the stepper motors.</p>
<h3 id=""><a href="#" class="headerlink" title=""></a><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/2/0/8205eec106324c6dbeac30870a3cbf2717add38f8074622f00ea084eb9b3f84d.webp" alt="Working-Principle of Stepper Motor"></h3><h2 id="Driving-Modes"><a href="#Driving-Modes" class="headerlink" title="Driving Modes"></a>Driving Modes</h2><p>There are several different ways of driving the stepper motor. The first one is the Wave Drive or Single-Coil Excitation. In this mode we active just one coil at a time which means that for this example of motor with 4 coils, the rotor will make full cycle in 4 steps.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/b/9/9/b9939002d37643d33418037cddd2b95c8a25d795d7e2dce487073a93b7074f6b.webp" alt="Wave-Drive Mode"></p>
<p>Next is the Full step drive mode which provides much higher torque output because we always have 2 active coils at a given time. However this doesn’t improve the resolution of the stepper and again the rotor will make a full cycle in 4 steps.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/e/3/6/e361de10c768298bd73b483a9123801ed5cf56ab73758464c7714f6ddc6d35fb.webp" alt="Full-Step-Drive-Mode"></p>
<p>For increasing the resolution of the stepper we use the Half Step Drive mode. This mode is actually a combination of the previous two modes.</p>
<p>Here we have one active coil followed by 2 active coils and then again one active coil followed by 2 active coils and so on. So with this mode we get double the resolution with the same construction. Now the rotor will make full cycle in 8 steps.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/0/5/3058046e959a7f488eb90772af53690fd6b277055179f31c18a39e7a8827374f.webp" alt="Half-Step-Drive-Mode"></p>
<p>However the most common method of <a target="_blank" rel="noopener" href="https://howtomechatronics.com/tutorials/arduino/how-to-control-stepper-motor-with-a4988-driver-and-arduino/">controlling stepper motors</a> nowadays is the Microstepping. In this mode we provide variable controlled current to the coils in form of sin wave. This will provide smooth motion of the rotor, decrease the stress of the parts and increase the accuracy of the stepper motor.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/b/7/a/b7adab85b8dcd66d66d9104eb116d7e3051e4b848cec19b486d801fa804f4981.webp" alt="Microstepping"></p>
<p>Another way of increasing the resolution of the stepper motor is by increasing the numbers of the poles of the rotor and the numbers of the pole of the stator.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/c/6/6/c6688d9d01156cc1cdd81bea4043c11921b7dad6d5be2ee92ca0effbbbde7f31.webp" alt="Incresing-Poles-Numbers0"></p>
<h2 id="Stepper-Motor-Types-by-Construction"><a href="#Stepper-Motor-Types-by-Construction" class="headerlink" title="Stepper Motor Types by Construction"></a>Stepper Motor Types by Construction</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/4/9/1/491ebb04d7f325434d35ff8d0b872323cf0ea0f74273d6c88b0d230f76d22629.webp" alt="By-Construction"></p>
<p>By construction there are 3 different types of stepper motors: permanent magnet stepper, variable reluctance stepper and hybrid synchronous stepper motor.  </p>
<p>The <strong>Permanent Magnet</strong> stepper has a permanent magnet rotor which is driven by the stators windings. They create opposite polarity poles compared to the poles of the rotor which propels the rotor.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/3/5/835e64339869a28573a1ac901a9582ff8e1f77b198a4350a8e063062142252fd.webp" alt="Stepper-Motor_PM"></p>
<p>The next type, the <strong>Variable Reluctant</strong> stepper motor uses a non-magnetizes soft iron rotor. The rotor has teeth that are offset from the stator and as we active the windings in a particular order the rotor moves respectively so that it has minimum gab between the stator and the teeth of the rotor</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/8/c/e/8ce93e32e1fbeca5e5cf931e7d54bd11cc158587d8277a4911c61ced82ded5ef.webp" alt="Stepper-Motor-Variable-Reluctant01"></p>
<p>The <strong>Hybrid Synchronous</strong> motor is combinations of the previous two steppers. It has permanent magnet toothed rotor and also a toothed stator. The rotor has two sections, which are opposite in polarity and their teeth are offset as shown here.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/5/3/9/5394c41590225fbe3c38f45792bcc7b3bb5c02ad2d9c06ea8540aa0502780360.webp" alt="Top-View-Rotor01"></p>
<p>This is a front view of a commonly used hybrid stepper motor which has 8 poles on the stator that are activated by 2 windings, A and B. So if we activate the winding A, we will magnetize 4 poles of which two of them will have South polarity and two of them North polarity.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/5/1/1/511f42953889fb208c178311e634f7d266ae2e2ab708cb1e2b611b8a3743339a.webp" alt="Hybrid-Stepper-Motor02"></p>
<p>We can see that in such a way the rotors teeth are aligned with the teeth of poles A and unaligned with the teeth of the poles B. That means that in the next step when we turn off the A poles and activate the B poles, the rotor will move counter clock wise and its teeth will align with the teeth of the B poles.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/f/7/8/f78daeff26514447538c8b9650e8eefeb46f56479872cd2fe9d5a8ada9f9b69e.webp" alt="Hybrid-Stepper-Motor_Working-P"></p>
<p>If we keep activating the poles in a particular order the rotor will move continuously. Here we can also use different driving modes like the wave drive, full step drive, half step drive and microstepping for even further increasing the resolution of the stepper motor</p>
<h2 id="步进电机基础知识"><a href="#步进电机基础知识" class="headerlink" title="步进电机基础知识"></a>步进电机基础知识</h2><p>步进电机是一种通过步进（即以固定的角度移动）方式使轴旋转的电机。其内部构造使它无需传感器，通过简单的步数计算即可获知轴的确切角位置。这种特性使它适用于多种应用。<br>转载：<a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/stepper-motors-basics-types-uses">步进电机基础知识：类型、用途和工作原理|技术文章|MPS (monolithicpower.cn)</a></p>
<h2 id="步进电机工作原理"><a href="#步进电机工作原理" class="headerlink" title="步进电机工作原理"></a>步进电机工作原理</h2><p>与所有电机一样，步进电机也包括固定部分（定子）和活动部分（转子）。定子上有缠绕了线圈的齿轮状突起，而转子为 <a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/energy-recycling-in-dc-motor-drives">永磁体</a>或可变磁阻铁芯。稍后我们将更深入地介绍不同的转子结构。图1显示的电机截面图，其转子为可变磁阻铁芯。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Section of a Stepper Motor"></p>
<p>图1: 步进电机截面图</p>
<p>步进电机的基本工作原理为：给一个或多个定子相位通电，线圈中通过的电流会产生磁场，而转子会与该磁场对齐；依次给不同的相位施加电压，转子将旋转特定的角度并最终到达需要的位置。图2显示了其工作原理。首先，线圈A通电并产生磁场，转子与该磁场对齐；线圈B通电后，转子顺时针旋转60°以与新的磁场对齐；线圈C通电后也会出现同样的情况。下图中定子小齿的颜色指示出定子绕组产生的磁场方向。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Stepper Motor Steps"></p>
<p>图2: 步进电机的步进</p>
<h2 id="步进电机的类型与构造"><a href="#步进电机的类型与构造" class="headerlink" title="步进电机的类型与构造"></a>步进电机的类型与构造</h2><p>步进电机的性能（无论是分辨率&#x2F;步距、速度还是扭矩）都受构造细节的影响，同时，这些细节也可能会影响电机的控制方式。实际上，并非所有步进电机都具有相同的内部结构（或构造），因为不同电机的转子和定子配置都不同。</p>
<h3 id="转子"><a href="#转子" class="headerlink" title="转子"></a>转子</h3><p>步进电机基本上有三种类型的转子：</p>
<ul>
<li>• 永磁转子：转子为永磁体，与定子电路产生的磁场对齐。这种转子可以保证良好的扭矩，并具有制动扭矩。这意味着，无论线圈是否通电，电机都能抵抗（即使不是很强烈）位置的变化。但与其他转子类型相比，其缺点是速度和分辨率都较低。图3显示了永磁步进电机的截面图。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Permanent Magnet Stepper Motor"></p>
<p>图3: 永磁步进电机</p>
<ul>
<li>• 可变磁阻转子：转子由铁芯制成，其形状特殊，可以与磁场对齐（请参见图1和图2）。这种转子更容易实现高速度和高分辨率，但它产生的扭矩通常较低，并且没有制动扭矩。</li>
<li>• 混合式转子：这种转子具有特殊的结构，它是永磁体和可变磁阻转子的混合体。其转子上有两个轴向磁化的磁帽，并且磁帽上有交替的小齿。这种配置使电机同时具有永磁体和可变磁阻转子的优势，尤其是具有高分辨率、高速度和大扭矩。当然更高的性能要求意味着更复杂的结构和更高的成本。图3显示了这种电机结构的简化示意图。线圈A通电后，转子N磁帽的一个小齿与磁化为S的定子齿对齐。与此同时，由于转子的结构，转子S磁帽与磁化为N的定子齿对齐。尽管步进电机的工作原理是相同的，但实际电机的结构更复杂，齿数要比图中所示的更多。大量的齿数可以使电机获得极小的步进角度，小至0.9°。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Hybrid stepper motor"></p>
<p>图4: 混合式步进电机</p>
<h3 id="定子"><a href="#定子" class="headerlink" title="定子"></a>定子</h3><p>定子是电机的一部分，负责产生转子与之对齐的磁场。定子电路的主要特性与其相数、极对数以及导线配置相关。 相数是独立线圈的数量，极对数则表示每相占用的主要齿对。两相步进电机最常用，三相和五相电机则较少使用（请参见图5和图6）。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Two-phase stator winding (left), three-phase stator winding (right)"></p>
<p>图5: 两相定子绕组（左）和三相定子绕组（右）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Two-phase, one pole pair stator (left), two-phase, two pole pair stator (right). The letters show the magnetic field generated when positive voltage is applied between A+ and A-"></p>
<p>图6：两相单极定子（左）和两相双极定子（右）。在A +和A-之间施加正电压时产生的磁场用字母N和S表示。</p>
<h2 id="步进电机的控制"><a href="#步进电机的控制" class="headerlink" title="步进电机的控制"></a>步进电机的控制</h2><p>从上文我们知道，电机线圈需要按特定的顺序通电，以产生转子将与之对齐的磁场。可以向线圈提供必要的电压以使电机正常运行的设备有以下几种（从距离电机更近的设备开始）：</p>
<ul>
<li>晶体管桥：从物理上控制电机线圈电气连接的设备。晶体管可以看作是电控断路器，它闭合时线圈连接到电源，线圈中才有电流通过。每个电机相位都需要一个晶体管电桥。</li>
<li>预驱动器：控制晶体管激活的设备，它由MCU控制以提供所需的电压和电流。</li>
<li>MCU：通常由电机用户编程控制的微控制器单元，它为预驱动器生成特定信号以获得所需的电机行为。</li>
</ul>
<p>图7为步进电机控制方案的简单示意图。预驱动器和晶体管电桥可以包含在单个设备中，即驱动器。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Motor control basic scheme"></p>
<p>图7: 电机控制基本方案</p>
<h3 id="步进电机驱动器类型"><a href="#步进电机驱动器类型" class="headerlink" title="步进电机驱动器类型"></a>步进电机驱动器类型</h3><p>市面上有各种不同的 <a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/products/motor-drivers/stepper-motor-drivers.html">步进电机驱动器</a>，它们针对特定应用具有不同的功能。但其最重要的特性之一与输入接口有关，最常见的几种输入接口包括：</p>
<ul>
<li>Step&#x2F;Direction （步进&#x2F;方向） –在Step引脚上发送一个脉冲，驱动器即改变其输出使电机执行一次步进，转动方向则由Direction引脚上的电平来决定。</li>
<li>Phase&#x2F;Enable（相位&#x2F;使能） –对每相的定子绕组来说，Enable决定该相是否通电， Phase决定该相电流方向，。</li>
<li>PWM – 直接控制上下管FET的栅极信号。</li>
</ul>
<p>步进电机驱动器的另一个重要特性是，除了控制绕组两端的电压，它是否还可以控制流过绕组的电流：</p>
<ul>
<li>拥有电压控制功能，驱动器可以调节绕组上的电压，产生的扭矩和步进速度仅取决于电机和负载特性。</li>
<li>电流控制驱动器更加先进，因为它们可以调节流经有源线圈的电流，更好地控制产生的扭矩，从而更好地控制整个系统的动态行为。</li>
</ul>
<h3 id="单极-双极电机"><a href="#单极-双极电机" class="headerlink" title="单极&#x2F;双极电机"></a>单极&#x2F;双极电机</h3><p>另一个可能对电机控制产生影响的特性是其定子线圈的布置，它决定了电流方向的变化方式。为了实现转子的运动，不仅要给线圈通电，还要控制电流的方向，而电流方向决定了线圈本身产生的磁场方向（见图8）。</p>
<p>步进电机可以通过两种不同的方法来控制电流的方向。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Direction of the magnetic field based on the direction of the coil current"></p>
<p>图8: 根据线圈电流方向控制磁场方向</p>
<p>在单极步进电机中，线圈的中心点连有一根引线（请参见图9），这样可以通过相对简单的电路和组件来控制电流方向。该中央引线（AM）连接输入电压VIN（见图8）。如果MOSFET 1导通，则电流从AM流向A +。如果MOSFET 2导通，则电流从AM流向A-，在相反方向上产生磁场。如上所述，这种方法可以简化驱动电路（仅需要两个半导体），但缺点是一次仅使用了电机中铜导体的一半，这意味着如果线圈中流过相同的电流 ，则磁场强度仅为使用全部铜导体时的一半。另外，由于电机输入引线更多，这类电机较难构造。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Unipolar Stepper Motor driving circuit"></p>
<p>图9: 单极步进电机驱动电路</p>
<p>在双极步进电机中，每个线圈只有两条引线，而且为了控制方向，必须使用H桥（请参见图10）。如图8所示，如果MOSFET 1和4导通，则电流从A +流向A-；如果MOSFET 2和3导通，则电流从A-流向A +，产生相反方向的磁场。这种方案需要更复杂的驱动电路，但可以最大限度利用电机铜量而实现最大扭矩。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Bipolar Stepper Motor driving circuit"></p>
<p>图10: 双极步进电机驱动电路</p>
<p>随着技术的不断进步，<a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/support/videos/stepper-motor-driver-from-mps.html">单极电机</a>的优势逐步弱化，双极步进电机成为目前最流行的电机类型。</p>
<h2 id="步进电机驱动技术"><a href="#步进电机驱动技术" class="headerlink" title="步进电机驱动技术"></a>步进电机驱动技术</h2><p>步进电机主要有四种不同的驱动技术：</p>
<ul>
<li>• 波动模式：一次仅一个相位通电（见图11）。为简单起见，如果电流从某相的正引线流向负引线（例如，从A +到A-），则我们称为正向流动；否则，称为负向流动。从下图左侧开始，电流仅在A相中正向流动，而用磁体代表的转子与其所产生的磁场对齐。接着，电流仅在B相中正向流动，转子顺时针旋转90°以与B相产生的磁场对齐。随后，A相再次通电，但电流负向流动 ，转子再次旋转90°。 最后，电流在B相中负向流动，而转子再次旋转90°。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Wave mode steps"></p>
<p>图11: 波动模式步进</p>
<ul>
<li>全步模式：两相始终同时通电。图12显示了该驱动模式的步进步骤。其步骤与波动模式类似，最大的区别在于，全步模式下，由于电机中流动的电流更多，产生的磁场也更强，因此扭矩也更大。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Full step mode steps"></p>
<p>图12: 全步模式步进</p>
<ul>
<li>半步模式是波动模式和全步模式的组合（请参见图12）。这种模式可以将步距减小一倍（旋转45°，而不是90°）。其唯一的缺点是电机产生的扭矩不是恒定的，当两相都通电时扭矩较高，只有一相通电时扭矩较小。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Half Step mode steps"></p>
<p>图13: 半步模式步进</p>
<ul>
<li>• 微步模式：可以看作是半步模式的增强版，因为它可以进一步减小步距，并且具有恒定的扭矩输出。这是通过控制每相流过的电流强度来实现的。与其他方案相比，微步模式需要更复杂的电机驱动器。图14显示了微步模式的工作原理。假设IMAX是一个相位中可以通过的最大电流，则从图中左侧开始，在第一个图中IA &#x3D; IMAX，IB &#x3D; 0。下一步，控制电流以达到IA &#x3D; 0.92 x IMAX，IB &#x3D; 0.38 x IMAX，它产生的磁场与前一个磁场相比顺时针旋转了22.5°。控制电流达到不同的电流值并重复此步骤，将磁场旋转45°、67.5°和90°。与半步模式相比，它将步距减少了一半；但还可以减少更多。使用微步模式可以达到非常高的位置分辨率，但其代价是需要更复杂的设备来控制电机，并且每次步进产生的扭矩也更小。扭矩与定子磁场和转子磁场之间的夹角正弦成正比；因此，当步距较小时，扭矩也较小。这有可能会导致丢步，也就是说，即使定子绕组中的电流发生了变化，转子的位置也可能不改变。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/assets/img/3/3/4/334253c49a2aa15d5cf3f0133eff518de747c6b08140bdcf73356d69741ae5b7.png" alt="Microstepping"></p>
<p>图14: 微步模式步进</p>
<h2 id="步进电机的优缺点"><a href="#步进电机的优缺点" class="headerlink" title="步进电机的优缺点"></a>步进电机的优缺点</h2><p>现在我们已了解了步进电机的工作原理，再总结一下各类电机的优缺点将非常有帮助。</p>
<h3 id="优点："><a href="#优点：" class="headerlink" title="优点："></a>优点：</h3><ul>
<li>得益于其内部结构，步进电机不需要传感器来检测电机位置。步进电机是通过执行“步进”来运动的，因此只需简单地计算步数就可以获得给定时间的电机位置。</li>
<li>此外，步进电机的控制非常简单。它也需要驱动器，但不需要复杂的计算或调整即可正常工作。与其他电机相比，其控制工作量通常很小。而且，如果采用微步模式，还可以实现高达0.007°的位置精度。</li>
<li>步进电机在低速时可提供良好的扭矩，也可以很好的保持位置，而且使用寿命长。</li>
</ul>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><ul>
<li>• 当负载扭矩过高时可能会失步。由于无法获知电机的实际位置，因此会对控制产生负面影响。采用微步模式时更易产生此问题。</li>
<li>• 步进电机即使在静止时也总是消耗最大电流，因此会降低效率并可能导致过热。</li>
<li>• 步进电机扭矩小，在高速下会产生很大的噪音。</li>
<li>• 步进电机具有低功率密度和低扭矩惯性比。</li>
</ul>
<p>总而言之，当您需要成本低廉、易于控制的解决方案，且对高速时的效率和扭矩要求不高时，步进电机是最好的选择。</p>
<p>要了解如何为您的项目选择正确的电机类型，并进一步了解步进电机、有刷电机和无刷电机之间的区别，请单击 <a target="_blank" rel="noopener" href="https://www.monolithicpower.cn/cn/catalog/category/view/id/535/">此处</a>。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738e9e3e093.png" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738e9e3e093.png" title="头像" alt="头像"></a><div class="post-copyright__author_name">Bin Lian</div><div class="post-copyright__author_desc">I think, therefore I am.</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/')">步进电机工作原理及使用,自动泡片机制作</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者｜Support the author"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>Support Me</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量｜Thank you for your support！</span><ul class="reward-group"><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/67738f609ac4d.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738f609ac4d.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/67738f5e864b9.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738f5e864b9.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li><li class="reward-item"><a href="https://buymeacoffee.com/bin_lian" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/677391ee18dba.png" alt="Buy me A coffee"/></a><div class="post-qr-code-desc">Buy me A coffee</div></li><li class="reward-item"><a href="https://lskypro.bin-lian.me/i/2024/12/31/6773928a646a1.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/6773928a646a1.jpg" alt="Paypal"/></a><div class="post-qr-code-desc">Paypal</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单｜List of supporters</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=步进电机工作原理及使用,自动泡片机制作&amp;url=http://example.com/2024/02/17/%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/&amp;pic=https://lskypro.bin-lian.me/i/2025/01/01/6774a45202abc.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/robotic/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>robotic<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/ProjChatGPT/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ProjChatGPT<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/AI-%E8%BE%85%E5%8A%A9%E5%AD%A6%E4%B9%A0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>AI 辅助学习<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/Projects/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Projects<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://lskypro.bin-lian.me/i/2025/02/13/67ad99c12374e.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/02/17/%E8%BF%99%E9%87%8C%E6%98%AF%E5%B8%B8%E6%9C%89%E7%9A%84%E6%9D%82%E6%83%B3%E5%92%8C%E8%84%91%E8%A2%8B%E7%9A%84%E5%A4%87%E4%BB%BD/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">这里是常有的杂想和脑袋的备份</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738e9e3e093.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/01/15/4129a14cfebf8.jpg" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">This is home for my<b style="color:#fff"> Projects, views, experiences</b>  of course<b style="color:#fff"> Music and Hobby</b><b style="color:#fff"></b>。</div>一起分享对世界的<div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);"><b style="color:#fff"></b>看法<b style="color:#fff">感悟</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">Bin Lian</h1><div class="author-info__desc">I think, therefore I am.</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/KIllerLB-USTC/" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/22893183" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="social-icon faa-parent animated-hover" href="https://www.linkedin.com/in/jakie-2843041bb" target="_blank" title="LinkedIn"><i class="fab fa-linkedin faa-tada"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E7%9A%84%E4%BB%A3%E7%A0%81%E5%92%8C%E5%AE%9E%E7%8E%B0%E7%9A%84%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">自己的代码和实现的项目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text">步进电机的基本原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E4%B8%8D%E5%90%8Cdriver-%E7%9A%84%E6%8E%A5%E7%BA%BF"><span class="toc-number">1.2.</span> <span class="toc-text">步进电机不同driver 的接线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Auto-immersion-lifter%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.3.</span> <span class="toc-text">Auto-immersion-lifter的实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Aduino-code"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">Aduino code:</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PCB%E6%9D%BF%E6%8E%A7%E5%88%B6%E7%AB%AF%EF%BC%8C%E7%BB%99%E5%87%BA%E4%B8%B2%E5%8F%A3%EF%BC%8C%E7%94%B1python%E6%8E%A5%E7%AE%A1%E8%B0%83%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">PCB板控制端，给出串口，由python接管调用功能</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-a-Stepper-Motor-and-How-It-Works"><span class="toc-number">2.</span> <span class="toc-text">What is a Stepper Motor and How It Works?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-To-Control-NEMA17-Stepper-Motor-with-Arduino-and-A4988-Stepper-Driver"><span class="toc-number">3.</span> <span class="toc-text">How To Control NEMA17 Stepper Motor with Arduino and A4988 Stepper Driver</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A4988-and-Arduino-Connection"><span class="toc-number">3.1.</span> <span class="toc-text">A4988 and Arduino Connection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#A4988-Current-Limiting"><span class="toc-number">3.2.</span> <span class="toc-text">A4988 Current Limiting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stepper-Motors-and-Arduino-%E2%80%93-Example-Codes"><span class="toc-number">4.</span> <span class="toc-text">Stepper Motors and Arduino – Example Codes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Controlling-Stepper-Motors-with-Arduino-and-the-AccelStepper-Library-%E2%80%93-Examples"><span class="toc-number">5.</span> <span class="toc-text">Controlling Stepper Motors with Arduino and the AccelStepper Library – Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-code-%E2%80%93-Stepper-motor-speed-control-using-a-potentiometer"><span class="toc-number">5.1.</span> <span class="toc-text">Example code – Stepper motor speed control using a potentiometer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-code-%E2%80%93-Controlling-two-stepper-motors-with-acceleration-and-deceleration"><span class="toc-number">5.2.</span> <span class="toc-text">Example code – Controlling two stepper motors with acceleration and deceleration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Example-code-%E2%80%93-Controlling-multiple-stepper-motors-with-AccelStepper-library"><span class="toc-number">5.3.</span> <span class="toc-text">Example code – Controlling multiple stepper motors with AccelStepper library</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CNC-shield-for-controlling-multiple-stepper-motors-for-any-Arduino-project"><span class="toc-number">6.</span> <span class="toc-text">CNC shield for controlling multiple stepper motors for any Arduino project</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DRV8825-vs-A4988"><span class="toc-number">7.</span> <span class="toc-text">DRV8825 vs A4988</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TMC2208-Stepper-Driver"><span class="toc-number">8.</span> <span class="toc-text">TMC2208 Stepper Driver</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%AD%A5%E8%BF%9B%E9%A9%B1%E5%8A%A8%E5%99%A8%E7%9A%84%E6%8E%A5%E7%BA%BF%E5%8F%8A%E8%AE%BE%E7%BD%AE"><span class="toc-number">8.1.</span> <span class="toc-text">2、步进驱动器的接线及设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E3%80%81%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%9A%84%E7%94%B5%E6%B5%81%E8%AE%BE%E7%BD%AE"><span class="toc-number">8.2.</span> <span class="toc-text">2.4、步进电机的电流设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%BB%86%E5%88%86%E9%A9%B1%E5%8A%A8%E8%AE%BE%E7%BD%AE"><span class="toc-number">8.3.</span> <span class="toc-text">3、细分驱动设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-the-Stepper-Motor-work-%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number"></span> <span class="toc-text">How the Stepper Motor work 步进电机工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Working-Principle"><span class="toc-number">1.</span> <span class="toc-text">Working Principle</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Driving-Modes"><span class="toc-number">2.</span> <span class="toc-text">Driving Modes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Stepper-Motor-Types-by-Construction"><span class="toc-number">3.</span> <span class="toc-text">Stepper Motor Types by Construction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">4.</span> <span class="toc-text">步进电机基础知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">步进电机工作原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%9A%84%E7%B1%BB%E5%9E%8B%E4%B8%8E%E6%9E%84%E9%80%A0"><span class="toc-number">6.</span> <span class="toc-text">步进电机的类型与构造</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E5%AD%90"><span class="toc-number">6.1.</span> <span class="toc-text">转子</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E5%AD%90"><span class="toc-number">6.2.</span> <span class="toc-text">定子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%9A%84%E6%8E%A7%E5%88%B6"><span class="toc-number">7.</span> <span class="toc-text">步进电机的控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.1.</span> <span class="toc-text">步进电机驱动器类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E6%9E%81-%E5%8F%8C%E6%9E%81%E7%94%B5%E6%9C%BA"><span class="toc-number">7.2.</span> <span class="toc-text">单极&#x2F;双极电机</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E9%A9%B1%E5%8A%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">8.</span> <span class="toc-text">步进电机驱动技术</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E8%BF%9B%E7%94%B5%E6%9C%BA%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">9.</span> <span class="toc-text">步进电机的优缺点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9%EF%BC%9A"><span class="toc-number">9.1.</span> <span class="toc-text">优点：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9%EF%BC%9A"><span class="toc-number">9.2.</span> <span class="toc-text">缺点：</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%20openwebui%20+%20Ollama/" title="本地部署 openwebui + Ollama"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67ad99c12374e.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="本地部署 openwebui + Ollama"/></a><div class="content"><a class="title" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2%20openwebui%20+%20Ollama/" title="本地部署 openwebui + Ollama">本地部署 openwebui + Ollama</a><time datetime="2025-02-11T20:28:55.212Z" title="Created 2025-02-11 14:28:55">2025-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/Teslamate%20%E7%9A%84%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE%EF%BC%8C%E7%88%B1%E8%BD%A6%E5%81%A5%E5%BA%B7%E4%BF%9D%E9%A9%BE%E6%8A%A4%E8%88%AA/" title="Teslamate 的本地配置，爱车健康保驾护航"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67ad9cba66384.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Teslamate 的本地配置，爱车健康保驾护航"/></a><div class="content"><a class="title" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/Teslamate%20%E7%9A%84%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE%EF%BC%8C%E7%88%B1%E8%BD%A6%E5%81%A5%E5%BA%B7%E4%BF%9D%E9%A9%BE%E6%8A%A4%E8%88%AA/" title="Teslamate 的本地配置，爱车健康保驾护航">Teslamate 的本地配置，爱车健康保驾护航</a><time datetime="2025-02-11T07:36:02.851Z" title="Created 2025-02-11 01:36:02">2025-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/%E3%80%90%E7%A7%81%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%8A%A9%E7%90%86%E3%80%91%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2RAGflow%20+%20Ollama,embedding%20%E6%A8%A1%E5%9E%8B/" title="本地部署RAGflow + Ollama, embedding 模型"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67ad9b383ed64.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="本地部署RAGflow + Ollama, embedding 模型"/></a><div class="content"><a class="title" href="/2025/02/11/docker%E9%A1%B9%E7%9B%AE/%E3%80%90%E7%A7%81%E4%BA%BA%E7%9F%A5%E8%AF%86%E5%8A%A9%E7%90%86%E3%80%91%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2RAGflow%20+%20Ollama,embedding%20%E6%A8%A1%E5%9E%8B/" title="本地部署RAGflow + Ollama, embedding 模型">本地部署RAGflow + Ollama, embedding 模型</a><time datetime="2025-02-11T07:08:02.541Z" title="Created 2025-02-11 01:08:02">2025-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/10/docker%E9%A1%B9%E7%9B%AE/Linux,%20ollama%20%E9%85%8D%E7%BD%AE,%E7%94%A8%E6%B3%95%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%B7%AF%E5%BE%84%E6%9B%B4%E6%94%B9%EF%BC%8C%E7%AB%AF%E5%8F%A3%E9%87%8A%E6%94%BE/" title="ollama 配置"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67ada41021ee4.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ollama 配置"/></a><div class="content"><a class="title" href="/2025/02/10/docker%E9%A1%B9%E7%9B%AE/Linux,%20ollama%20%E9%85%8D%E7%BD%AE,%E7%94%A8%E6%B3%95%EF%BC%8C%E9%BB%98%E8%AE%A4%E8%B7%AF%E5%BE%84%E6%9B%B4%E6%94%B9%EF%BC%8C%E7%AB%AF%E5%8F%A3%E9%87%8A%E6%94%BE/" title="ollama 配置">ollama 配置</a><time datetime="2025-02-10T21:56:16.000Z" title="Created 2025-02-10 15:56:16">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/01/20/Modern%20CPU%20Manufacturing%20From%20Sand%20to%20Silicon/" title="Modern CPU Manufacturing: From Sand to Silicon"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/01/21/678f103bbdb59.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Modern CPU Manufacturing: From Sand to Silicon"/></a><div class="content"><a class="title" href="/2025/01/20/Modern%20CPU%20Manufacturing%20From%20Sand%20to%20Silicon/" title="Modern CPU Manufacturing: From Sand to Silicon">Modern CPU Manufacturing: From Sand to Silicon</a><time datetime="2025-01-21T02:58:11.843Z" title="Created 2025-01-20 20:58:11">2025-01-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 - 2025 By <a class="footer-bar-link" href="/" title="Bin Lian" target="_blank">Bin Lian</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="Theme AnZhiYu">Theme AnZhiYu</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">20</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">10</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">Website</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.bin-lian.me" title="My homepage"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/67738e9e3e093.png" alt="My homepage"/><span class="back-menu-item-text">My homepage</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">My services</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://lskypro.bin-lian.me/" title="Image Bed for Bin"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2024/12/31/677393fd15929.png" alt="Image Bed for Bin"/><span class="back-menu-item-text">Image Bed for Bin</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://myteslamate.bin-lian.me/" title="Teslamate"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67adaeace24f7.png" alt="Teslamate"/><span class="back-menu-item-text">Teslamate</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">Local LLM &amp; knowledge database</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://myragflow.bin-lian.me/" title="RAGflow"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://lskypro.bin-lian.me/i/2025/02/13/67adae37f12cd.png" alt="RAGflow"/><span class="back-menu-item-text">RAGflow</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> Posts</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> Archives</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> Categories</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> About Me</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> About Me</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> Life News</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> Random Post</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> Personal</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> Music</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> Album</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E8%AE%BA%E8%AF%AD/" style="font-size: 0.88rem;">#论语<sup>1</sup></a><a href="/tags/AI-%E8%BE%85%E5%8A%A9%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">AI 辅助学习<sup>1</sup></a><a href="/tags/LLM/" style="font-size: 0.88rem;">LLM<sup>3</sup></a><a href="/tags/Mytesla/" style="font-size: 0.88rem;">Mytesla<sup>1</sup></a><a href="/tags/ProjChatGPT/" style="font-size: 0.88rem;">ProjChatGPT<sup>1</sup></a><a href="/tags/Projects/" style="font-size: 0.88rem;">Projects<sup>1</sup></a><a href="/tags/QuickNote/" style="font-size: 0.88rem;">QuickNote<sup>1</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>7</sup></a><a href="/tags/hexo/" style="font-size: 0.88rem;">hexo<sup>4</sup></a><a href="/tags/linux/" style="font-size: 0.88rem;">linux<sup>1</sup></a><a href="/tags/obsidian/" style="font-size: 0.88rem;">obsidian<sup>1</sup></a><a href="/tags/robotic/" style="font-size: 0.88rem;">robotic<sup>1</sup></a><a href="/tags/semiconductor/" style="font-size: 0.88rem;">semiconductor<sup>1</sup></a><a href="/tags/%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BC%80%E5%A7%8B/" style="font-size: 0.88rem;">为什么开始<sup>1</sup></a><a href="/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/" style="font-size: 0.88rem;">内网穿透<sup>1</sup></a><a href="/tags/%E5%9B%BE%E5%BA%8A/" style="font-size: 0.88rem;">图床<sup>1</sup></a><a href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/" style="font-size: 0.88rem;">小技巧<sup>1</sup></a><a href="/tags/%E6%8C%87%E5%BC%B9%E7%BB%83%E4%B9%A0/" style="font-size: 0.88rem;">指弹练习<sup>1</sup></a><a href="/tags/%E8%A7%85%E9%A3%9F%E8%AE%B0/" style="font-size: 0.88rem;">觅食记<sup>1</sup></a><a href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" style="font-size: 0.88rem;">读书笔记<sup>1</sup></a></div></div><hr/></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift F</div></div><div class="keyContent"><div class="content">友链鱼塘</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">play music</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=437998513&amp;userid=315226254&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("12/16/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2024 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Bin Lian 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.bin-lian.me/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.bin-lian.me/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.bin-lian.me/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "Unable to get the data, please make sure the settings are correct."
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>